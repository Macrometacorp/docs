"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[61415],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>d});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),u=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(a),d=r,k=p["".concat(s,".").concat(d)]||p[d]||m[d]||o;return a?n.createElement(k,l(l({ref:t},c),{},{components:a})):n.createElement(k,l({ref:t},c))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var u=2;u<o;u++)l[u]=a[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},995:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var n=a(87462),r=(a(67294),a(3905));const o={sidebar_position:10,title:"Part 1 - Basic Document Tasks"},l=void 0,i={unversionedId:"queryworkers/c8ql/got-tutorial/c8ql-crud",id:"queryworkers/c8ql/got-tutorial/c8ql-crud",title:"Part 1 - Basic Document Tasks",description:"You can perform basic document tasks such as create, read, update, and delete (CRUD) on documents in a collection. This portion of the tutorial guides you through those tasks.",source:"@site/docs/queryworkers/c8ql/got-tutorial/c8ql-crud.md",sourceDirName:"queryworkers/c8ql/got-tutorial",slug:"/queryworkers/c8ql/got-tutorial/c8ql-crud",permalink:"/docs/queryworkers/c8ql/got-tutorial/c8ql-crud",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/queryworkers/c8ql/got-tutorial/c8ql-crud.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10,title:"Part 1 - Basic Document Tasks"},sidebar:"defaultSidebar",previous:{title:"C8QL GoT Tutorial",permalink:"/docs/queryworkers/c8ql/got-tutorial/"},next:{title:"Part 2 - Filter Results",permalink:"/docs/queryworkers/c8ql/got-tutorial/filter-results"}},s={},u=[{value:"Create the Characters Collection",id:"create-the-characters-collection",level:2},{value:"Create Documents",id:"create-documents",level:2},{value:"Add One Document to the Collection",id:"add-one-document-to-the-collection",level:3},{value:"Explanation of Adding One Document",id:"explanation-of-adding-one-document",level:3},{value:"Add Multiple Documents to the Collection",id:"add-multiple-documents-to-the-collection",level:3},{value:"Explanation of Adding Multiple Documents",id:"explanation-of-adding-multiple-documents",level:3},{value:"Read Documents",id:"read-documents",level:2},{value:"Read All Documents",id:"read-all-documents",level:3},{value:"Explanation of Reading All Documents",id:"explanation-of-reading-all-documents",level:3},{value:"Read Specific Documents",id:"read-specific-documents",level:3},{value:"Read One Specific Document",id:"read-one-specific-document",level:4},{value:"Read Multiple Specific Documents",id:"read-multiple-specific-documents",level:4},{value:"Update Documents",id:"update-documents",level:2},{value:"Update a Single Document",id:"update-a-single-document",level:3},{value:"Explanation of Updating a Single Document",id:"explanation-of-updating-a-single-document",level:3},{value:"Update All Documents",id:"update-all-documents",level:3},{value:"Delete Documents",id:"delete-documents",level:2},{value:"Delete Specific Documents",id:"delete-specific-documents",level:3},{value:"Delete All Documents",id:"delete-all-documents",level:3},{value:"Next Steps",id:"next-steps",level:2}],c={toc:u};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"You can perform basic document tasks such as create, read, update, and delete (CRUD) on documents in a collection. This portion of the tutorial guides you through those tasks."),(0,r.kt)("h2",{id:"create-the-characters-collection"},"Create the Characters Collection"),(0,r.kt)("p",null,"Before we can insert documents with C8QL, we need a place to put them in: a collection."),(0,r.kt)("p",null,"For this tutorial, ",(0,r.kt)("a",{parentName:"p",href:"/docs/collections/documents/create-document-store"},"Create a Document Store collection")," in the console. For more information about collections, refer to ",(0,r.kt)("a",{parentName:"p",href:"/docs/collections/"},"Collections"),"."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"https://auth-play.macrometa.io/"},"Log in to your Macrometa account"),"."),(0,r.kt)("li",{parentName:"ol"},"Click ",(0,r.kt)("strong",{parentName:"li"},"Data > Collections"),"."),(0,r.kt)("li",{parentName:"ol"},"Click ",(0,r.kt)("strong",{parentName:"li"},"New Collection"),"."),(0,r.kt)("li",{parentName:"ol"},"Click ",(0,r.kt)("strong",{parentName:"li"},"Document Store"),"."),(0,r.kt)("li",{parentName:"ol"},"Name the collection ",(0,r.kt)("strong",{parentName:"li"},"Characters")," and then click ",(0,r.kt)("strong",{parentName:"li"},"Create"),".")),(0,r.kt)("h2",{id:"create-documents"},"Create Documents"),(0,r.kt)("p",null,"You can create documents one at a time or in a batch. In this section, you use C8QL queries to do both. For more information, refer to the ",(0,r.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/operations/insert"},"INSERT")," operation and ",(0,r.kt)("a",{parentName:"p",href:"/docs/queryworkers/"},"Queries and Query Workers"),"."),(0,r.kt)("p",null,"For more information about this task, refer to ",(0,r.kt)("a",{parentName:"p",href:"/docs/collections/documents/add-document"},"Add Documents to a Collection"),"."),(0,r.kt)("h3",{id:"add-one-document-to-the-collection"},"Add One Document to the Collection"),(0,r.kt)("p",null,"Add one document to the collection with a query."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Compute > Query Workers"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following C8QL query into the query editor on the Editor tab."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},'INSERT {\n    "name": "Ned",\n    "surname": "Stark",\n    "alive": true,\n    "age": 41,\n    "traits": ["A","H","C","N","P"]\n} INTO Characters\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa returns an empty list, because the query did not ",(0,r.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/operations/return"},"RETURN")," anything. We'll do that in a later step."),(0,r.kt)("p",null,"If you want to see your new record, click ",(0,r.kt)("strong",{parentName:"p"},"Data > Collections")," and then click ",(0,r.kt)("strong",{parentName:"p"},"Characters"),". Your brand new Ned Stark record is right there."),(0,r.kt)("h3",{id:"explanation-of-adding-one-document"},"Explanation of Adding One Document"),(0,r.kt)("p",null,"The syntax for this query is ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT document INTO collectionName"),". The document is an object like you may know it from JavaScript or JSON, which is comprised of attribute key and value pairs. The quotes around the attribute keys are optional in C8QL. Keys are always character sequences (strings), whereas attribute values can have different types:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"null"),(0,r.kt)("li",{parentName:"ul"},"boolean (true, false)"),(0,r.kt)("li",{parentName:"ul"},"number (integer and floating point)"),(0,r.kt)("li",{parentName:"ul"},"string"),(0,r.kt)("li",{parentName:"ul"},"array"),(0,r.kt)("li",{parentName:"ul"},"object")),(0,r.kt)("p",null,"Name and surname of the character document we inserted are both string values. The alive state uses a boolean. Age is a numeric value. The traits are an array of strings. The entire document is an object."),(0,r.kt)("h3",{id:"add-multiple-documents-to-the-collection"},"Add Multiple Documents to the Collection"),(0,r.kt)("p",null,"Let's add the rest of our characters with a single query. If you are familiar with FOR loops iterating through lists, this will be very familiar."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Compute > Query Workers")," (if you are not already in that section).")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following C8QL query into the query editor on the Editor tab."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},'LET data = [\n    { "name": "Robert", "surname": "Baratheon", "alive": false, "traits": ["A","H","C"] },\n    { "name": "Jaime", "surname": "Lannister", "alive": true, "age": 36, "traits": ["A","F","B"] },\n    { "name": "Catelyn", "surname": "Stark", "alive": false, "age": 40, "traits": ["D","H","C"] },\n    { "name": "Cersei", "surname": "Lannister", "alive": true, "age": 36, "traits": ["H","E","F"] },\n    { "name": "Daenerys", "surname": "Targaryen", "alive": true, "age": 16, "traits": ["D","H","C"] },\n    { "name": "Jorah", "surname": "Mormont", "alive": false, "traits": ["A","B","C","F"] },\n    { "name": "Petyr", "surname": "Baelish", "alive": false, "traits": ["E","G","F"] },\n    { "name": "Viserys", "surname": "Targaryen", "alive": false, "traits": ["O","L","N"] },\n    { "name": "Jon", "surname": "Snow", "alive": true, "age": 16, "traits": ["A","B","C","F"] },\n    { "name": "Sansa", "surname": "Stark", "alive": true, "age": 13, "traits": ["D","I","J"] },\n    { "name": "Arya", "surname": "Stark", "alive": true, "age": 11, "traits": ["C","K","L"] },\n    { "name": "Robb", "surname": "Stark", "alive": false, "traits": ["A","B","C","K"] },\n    { "name": "Theon", "surname": "Greyjoy", "alive": true, "age": 16, "traits": ["E","R","K"] },\n    { "name": "Bran", "surname": "Stark", "alive": true, "age": 10, "traits": ["L","J"] },\n    { "name": "Joffrey", "surname": "Baratheon", "alive": false, "age": 19, "traits": ["I","L","O"] },\n    { "name": "Sandor", "surname": "Clegane", "alive": true, "traits": ["A","P","K","F"] },\n    { "name": "Tyrion", "surname": "Lannister", "alive": true, "age": 32, "traits": ["F","K","M","N"] },\n    { "name": "Khal", "surname": "Drogo", "alive": false, "traits": ["A","C","O","P"] },\n    { "name": "Tywin", "surname": "Lannister", "alive": false, "traits": ["O","M","H","F"] },\n    { "name": "Davos", "surname": "Seaworth", "alive": true, "age": 49, "traits": ["C","K","P","F"] },\n    { "name": "Samwell", "surname": "Tarly", "alive": true, "age": 17, "traits": ["C","L","I"] },\n    { "name": "Stannis", "surname": "Baratheon", "alive": false, "traits": ["H","O","P","M"] },\n    { "name": "Melisandre", "alive": true, "traits": ["G","E","H"] },\n    { "name": "Margaery", "surname": "Tyrell", "alive": false, "traits": ["M","D","B"] },\n    { "name": "Jeor", "surname": "Mormont", "alive": false, "traits": ["C","H","M","P"] },\n    { "name": "Bronn", "alive": true, "traits": ["K","E","C"] },\n    { "name": "Varys", "alive": true, "traits": ["M","F","N","E"] },\n    { "name": "Shae", "alive": false, "traits": ["M","D","G"] },\n    { "name": "Talisa", "surname": "Maegyr", "alive": false, "traits": ["D","C","B"] },\n    { "name": "Gendry", "alive": false, "traits": ["K","C","A"] },\n    { "name": "Ygritte", "alive": false, "traits": ["A","P","K"] },\n    { "name": "Tormund", "surname": "Giantsbane", "alive": true, "traits": ["C","P","A","I"] },\n    { "name": "Gilly", "alive": true, "traits": ["L","J"] },\n    { "name": "Brienne", "surname": "Tarth", "alive": true, "age": 32, "traits": ["P","C","A","K"] },\n    { "name": "Ramsay", "surname": "Bolton", "alive": true, "traits": ["E","O","G","A"] },\n    { "name": "Ellaria", "surname": "Sand", "alive": true, "traits": ["P","O","A","E"] },\n    { "name": "Daario", "surname": "Naharis", "alive": true, "traits": ["K","P","A"] },\n    { "name": "Missandei", "alive": true, "traits": ["D","L","C","M"] },\n    { "name": "Tommen", "surname": "Baratheon", "alive": true, "traits": ["I","L","B"] },\n    { "name": "Jaqen", "surname": "H\'ghar", "alive": true, "traits": ["H","F","K"] },\n    { "name": "Roose", "surname": "Bolton", "alive": true, "traits": ["H","E","F","A"] },\n    { "name": "The High Sparrow", "alive": true, "traits": ["H","M","F","O"] }\n]\n\nFOR d IN data\n    INSERT d INTO Characters\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa returns an empty list. As before, you can manually look at the records in the ",(0,r.kt)("strong",{parentName:"p"},"Collections")," screen, or retrieve them with queries in the next section."),(0,r.kt)("h3",{id:"explanation-of-adding-multiple-documents"},"Explanation of Adding Multiple Documents"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"LET")," keyword defines a variable with name ",(0,r.kt)("em",{parentName:"p"},"data")," and an array of objects as value, so ",(0,r.kt)("inlineCode",{parentName:"p"},"LET variableName = valueExpression")," and the expression being a literal array definition like ",(0,r.kt)("inlineCode",{parentName:"p"},"[ {...}, {...}, ... ]"),"."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"FOR variableName IN expression")," is used to iterate over each element of the ",(0,r.kt)("em",{parentName:"p"},"data")," array. In each loop, one element is assigned to the variable ",(0,r.kt)("em",{parentName:"p"},"d"),". This variable is then used in the ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," statement instead of a literal object definition. What is does is basically:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'INSERT {\n    "name": "Robert",\n    "surname": "Baratheon",\n    "alive": false,\n    "traits": ["A","H","C"]\n} INTO Characters\n\nINSERT {\n    "name": "Jaime",\n    "surname": "Lannister",\n    "alive": true,\n    "age": 36,\n    "traits": ["A","F","B"]\n} INTO Characters\n\n...\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"C8QL does not permit multiple ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," operations that target the same collection in a single query. It is allowed as body of a ",(0,r.kt)("inlineCode",{parentName:"p"},"FOR")," loop however, inserting multiple documents like you did in the above query.")),(0,r.kt)("h2",{id:"read-documents"},"Read Documents"),(0,r.kt)("p",null,"With C8QL queries, you can retrieve all documents or specific documents. This section demonstrates both methods."),(0,r.kt)("h3",{id:"read-all-documents"},"Read All Documents"),(0,r.kt)("p",null,"You can retrieve documents (characters) in the ",(0,r.kt)("em",{parentName:"p"},"Characters")," collection by using a ",(0,r.kt)("inlineCode",{parentName:"p"},"FOR")," loop again. This time however, we use it to go through all documents in the collection instead of an array."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the Query Workers screen, paste the following code block in the editor:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"FOR c IN Characters\n    RETURN c\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa lists all records in the Query Result."),(0,r.kt)("h3",{id:"explanation-of-reading-all-documents"},"Explanation of Reading All Documents"),(0,r.kt)("p",null,"The syntax of the loop is ",(0,r.kt)("inlineCode",{parentName:"p"},"FOR variableName IN collectionName"),". For each document in the collection, ",(0,r.kt)("em",{parentName:"p"},"c")," is assigned a document, which is then returned as per the loop body. The query returns all characters that were previously stored."),(0,r.kt)("p",null,"Among them should be ",(0,r.kt)("em",{parentName:"p"},"Ned Stark"),", similar to this example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'  {\n    "_key": "2861650",\n    "_id": "Characters/2861650",\n    "_rev": "_V1bzsXa---",\n    "name": "Ned",\n    "surname": "Stark",\n    "alive": true,\n    "age": 41,\n    "traits": ["A","H","C","N","P"]\n  },\n')),(0,r.kt)("p",null,"The document features the five attributes you stored, plus three more added by the database system. Each document needs a unique ",(0,r.kt)("inlineCode",{parentName:"p"},"_key"),", which identifies it within a collection. Document keys can be provided by the user upon document creation, or a unique value is assigned automatically. Once created, document keys cannot be changed."),(0,r.kt)("p",null,"All three system attributes starting with an underscore ",(0,r.kt)("inlineCode",{parentName:"p"},"_")," are read-only. The ",(0,r.kt)("inlineCode",{parentName:"p"},"_id")," is a computed property, a concatenation of the collection name, a forward slash ",(0,r.kt)("inlineCode",{parentName:"p"},"/")," and the document key. It uniquely identies a document within a database. ",(0,r.kt)("inlineCode",{parentName:"p"},"_rev")," is a revision ID managed by the system."),(0,r.kt)("h3",{id:"read-specific-documents"},"Read Specific Documents"),(0,r.kt)("p",null,"You can use either the document key or the document ID to retrieve a specific document with the help of a C8QL function ",(0,r.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/functions/document"},"DOCUMENT()"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Document keys will be different for you. Update the queries accordingly.")),(0,r.kt)("h4",{id:"read-one-specific-document"},"Read One Specific Document"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste one of the following commands in the editor. Notice that the command includes the collection name and a document key."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},'RETURN DOCUMENT("Characters", "2861650")\n// --- or ---\nRETURN DOCUMENT("Characters/2861650")\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Replace the document key with the key from the first record in the results of the previous query.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa returns something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "_key": "2861650",\n    "_id": "Characters/2861650",\n    "_rev": "_V1bzsXa---",\n    "name": "Ned",\n    "surname": "Stark",\n    "alive": true,\n    "age": 41,\n    "traits": ["A","H","C","N","P"]\n  }\n]\n')),(0,r.kt)("h4",{id:"read-multiple-specific-documents"},"Read Multiple Specific Documents"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"DOCUMENT()")," function also allows you to fetch multiple documents at once."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste one of the following commands in the editor."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},'RETURN DOCUMENT("Characters", ["2861650", "2861653"])\n// --- or ---\nRETURN DOCUMENT(["Characters/2861650", "Characters/2861653"])\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Replace the document keys with keys from the first and fourth records in the results of the previous query.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa returns something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n  [\n    {\n      "_key": "2861650",\n      "_id": "Characters/2861650",\n      "_rev": "_V1bzsXa---",\n      "name": "Ned",\n      "surname": "Stark",\n      "alive": true,\n      "age": 41,\n      "traits": ["A","H","C","N","P"]\n    },\n    {\n      "_key": "2861653",\n      "_id": "Characters/2861653",\n      "_rev": "_V1bzsXa--B",\n      "name": "Catelyn",\n      "surname": "Stark",\n      "alive": false,\n      "age": 40,\n      "traits": ["D","H","C"]\n    }\n  ]\n]\n')),(0,r.kt)("p",null,"For more information, refer to the ",(0,r.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/functions/document"},"DOCUMENT()")," function documentation."),(0,r.kt)("h2",{id:"update-documents"},"Update Documents"),(0,r.kt)("p",null,"With C8QL queries, you can update specific documents or all documents. This section demonstrates both methods."),(0,r.kt)("h3",{id:"update-a-single-document"},"Update a Single Document"),(0,r.kt)("p",null,"According to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Ned Stark")," document, he is alive. Because he died by the end of the season, you need to change the ",(0,r.kt)("inlineCode",{parentName:"p"},"alive")," attribute in the existing document."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the previous section, you used Ned Stark's record key. Make sure you still have it handy.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following command in the editor."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},'UPDATE "2861650" WITH { alive: false } IN Characters\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Replace the key value with Ned Stark's record key.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa updates the record and returns an empty list. To see the update, you can run one of the read queries from the previous section."),(0,r.kt)("h3",{id:"explanation-of-updating-a-single-document"},"Explanation of Updating a Single Document"),(0,r.kt)("p",null,"The syntax is ",(0,r.kt)("inlineCode",{parentName:"p"},"UPDATE documentKey WITH object IN collectionName"),". It updates the specified document with the attributes listed (or adds them if they don't exist), but leaves the rest untouched. To replace the entire document content, you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"REPLACE")," instead of ",(0,r.kt)("inlineCode",{parentName:"p"},"UPDATE"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'REPLACE "2861650" WITH {\n    name: "Ned",\n    surname: "Stark",\n    alive: false,\n    age: 41,\n    traits: ["A","H","C","N","P"]\n} IN Characters\n')),(0,r.kt)("h3",{id:"update-all-documents"},"Update All Documents"),(0,r.kt)("p",null,"To add a new attribute to all documents, you might run the previous command for updating a single document with a FOR loop. A variable is used instead of a literal document key, to update each document. The query adds an attribute ",(0,r.kt)("inlineCode",{parentName:"p"},"season")," to the documents' top-level."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following command in the editor."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"FOR c IN Characters\n    UPDATE c WITH { season: 1 } IN Characters\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa returns an empty list. You can inspect the result by re-running the query that returns all documents in collection:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"FOR c IN Characters\n    RETURN c\n")),(0,r.kt)("p",null,"Records now have a ",(0,r.kt)("inlineCode",{parentName:"p"},"season")," attribute."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n  [\n    {\n      "_key": "2861650",\n      "_id": "Characters/2861650",\n      "_rev": "_V1bzsXa---",\n      "name": "Ned",\n      "surname": "Stark",\n      "alive": false,\n      "age": 41,\n      "traits": ["A","H","C","N","P"],\n      "season": 1\n    },\n    {\n      "_key": "2861653",\n      "_id": "Characters/2861653",\n      "_rev": "_V1bzsXa--B",\n      "name": "Catelyn",\n      "surname": "Stark",\n      "alive": false,\n      "age": 40,\n      "traits": ["D","H","C"],\n      "season": 1\n    },\n    {\n        ...\n    }\n  ]\n]\n')),(0,r.kt)("h2",{id:"delete-documents"},"Delete Documents"),(0,r.kt)("p",null,"With C8QL queries, you can delete specific documents or all documents. This section demonstrates both methods."),(0,r.kt)("h3",{id:"delete-specific-documents"},"Delete Specific Documents"),(0,r.kt)("p",null,"To fully remove documents from a collection, there is the ",(0,r.kt)("inlineCode",{parentName:"p"},"REMOVE")," operation. It works similar to the other modification operations, but without a ",(0,r.kt)("inlineCode",{parentName:"p"},"WITH")," clause."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following command in the editor."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},'REMOVE "2861650" IN Characters\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Replace the key in the example with any key from your document collection.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa deletes the document and returns an empty list."),(0,r.kt)("h3",{id:"delete-all-documents"},"Delete All Documents"),(0,r.kt)("p",null,"You can also use ",(0,r.kt)("inlineCode",{parentName:"p"},"REMOVE")," in a loop body to effectively truncate a collection, removing all records without deleting the collection."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"New Query"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following command in the editor."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"FOR c IN Characters\n    REMOVE c IN Characters\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Run Query"),"."))),(0,r.kt)("p",null,"Macrometa deletes all documents and returns an empty list. To view the results, navigate to the Colections screen and click your collection or run the query to view all documents."),(0,r.kt)("admonition",{type:"important"},(0,r.kt)("p",{parentName:"admonition"},"Re-run the ",(0,r.kt)("a",{parentName:"p",href:"#create-documents"},"insert queries")," at the top with all character documents before you continue with the next chapter, to have data to work with again. And don't forget good, old Ned Stark! We're not through picking on him.")),(0,r.kt)("h2",{id:"next-steps"},"Next Steps"),(0,r.kt)("p",null,"Great job! You have created a collection and performed basic CRUD operations. When you're ready, continue the tutorial in ",(0,r.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/got-tutorial/filter-results"},"Part 2 - Filter Results"),"."))}m.isMDXComponent=!0}}]);