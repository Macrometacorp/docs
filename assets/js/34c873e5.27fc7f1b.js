"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[96432],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>d});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),u=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=u(a),d=r,k=c["".concat(s,".").concat(d)]||c[d]||p[d]||i;return a?n.createElement(k,l(l({ref:t},m),{},{components:a})):n.createElement(k,l({ref:t},m))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=a[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},14526:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>u});var n=a(87462),r=(a(67294),a(3905));const i={title:"C8QL Syntax"},l=void 0,o={unversionedId:"queryworkers/c8ql/c8ql-syntax",id:"queryworkers/c8ql/c8ql-syntax",title:"C8QL Syntax",description:"This page explains the structure of the C8QL language.",source:"@site/docs/queryworkers/c8ql/c8ql-syntax.md",sourceDirName:"queryworkers/c8ql",slug:"/queryworkers/c8ql/c8ql-syntax",permalink:"/docs/queryworkers/c8ql/c8ql-syntax",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/queryworkers/c8ql/c8ql-syntax.md",tags:[],version:"current",frontMatter:{title:"C8QL Syntax"},sidebar:"defaultSidebar",previous:{title:"Common Errors",permalink:"/docs/queryworkers/c8ql/common-errors"},next:{title:"Data Types",permalink:"/docs/queryworkers/c8ql/data-types"}},s={},u=[{value:"Query types",id:"query-types",level:2},{value:"Whitespace",id:"whitespace",level:2},{value:"Comments",id:"comments",level:2},{value:"Keywords",id:"keywords",level:2},{value:"Names",id:"names",level:2},{value:"Collection Names",id:"collection-names",level:2},{value:"Attribute Names",id:"attribute-names",level:2},{value:"Variable Names",id:"variable-names",level:2}],m={toc:u};function p(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This page explains the structure of the C8QL language."),(0,r.kt)("h2",{id:"query-types"},"Query types"),(0,r.kt)("p",null,"A C8QL query must either return a result (indicated by usage of the ",(0,r.kt)("inlineCode",{parentName:"p"},"RETURN")," keyword) or execute a data-modification operation (indicated by usage of one of the keywords ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"UPDATE"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"REPLACE"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"REMOVE")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"UPSERT"),")."),(0,r.kt)("p",null,"The C8QL parser will return an error if it detects more than one data-modification operation in the same query or if it cannot figure out if the query is meant to be a data retrieval or a modification operation."),(0,r.kt)("p",null,"C8QL only allows ",(0,r.kt)("em",{parentName:"p"},"one")," query in a single query string; thus semicolons to indicate the end of one query and separate multiple queries (as seen in SQL) are not allowed."),(0,r.kt)("h2",{id:"whitespace"},"Whitespace"),(0,r.kt)("p",null,"Whitespaces (blanks, carriage returns, line feeds, and tab stops) can be used in the query text to increase its readability. Tokens have to be separated by any number of whitespaces. Whitespace within strings or names must be enclosed in quotes in order to be preserved."),(0,r.kt)("h2",{id:"comments"},"Comments"),(0,r.kt)("p",null,"Comments can be embedded at any position in a query. The text contained in the comment is ignored by the C8QL parser."),(0,r.kt)("p",null,"Multi-line comments cannot be nested, which means subsequent comment starts within comments are ignored, comment ends will end the comment."),(0,r.kt)("p",null,"C8QL supports two types of comments:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Single line comments: These start with a double forward slash and end at the end of the line, or the end of the query string (whichever is first).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Multi line comments: These start with a forward slash and asterisk, and end with an asterisk and a following forward slash. They can span as many lines as necessary."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"    /* this is a comment */ RETURN 1\n    /* these */ RETURN /* are */ 1 /* multiple */ + /* comments */ 1\n    /* this is\n       a multi line\n       comment */\n    // a single line comment\n")),(0,r.kt)("h2",{id:"keywords"},"Keywords"),(0,r.kt)("p",null,"On the top level, C8QL offers the following operations:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"FOR"),": array iteration"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"RETURN"),": results projection"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"FILTER"),": results filtering"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"SORT"),": result sorting"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"LIMIT"),": result slicing"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"LET"),": variable assignment"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"COLLECT"),": result grouping"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"INSERT"),": insertion of new documents"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"UPDATE"),": (partial) update of existing documents"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"REPLACE"),": replacement of existing documents"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"REMOVE"),": removal of existing documents"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"UPSERT"),": insertion or update of existing documents")),(0,r.kt)("p",null,"Each of the above operations can be initiated in a query by using a keyword of the same name. A C8QL query can (and typically does) consist of multiple of the above operations."),(0,r.kt)("p",null,"An example C8QL query may look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'FOR u IN users\n  FILTER u.type == "newbie" && u.active == true\n  RETURN u.name\n')),(0,r.kt)("p",null,"In this example query, the terms ",(0,r.kt)("inlineCode",{parentName:"p"},"FOR"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"FILTER"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"RETURN")," initiate the higher-level operation according to their name. These terms are also keywords, meaning that they have a special meaning in the language."),(0,r.kt)("p",null,"For example, the query parser will use the keywords to find out which high-level operations to execute. That also means keywords can only be used at certain locations in a query. This also makes all keywords reserved words that must not be used for other purposes than they are intended for."),(0,r.kt)("p",null,"For example, it is not possible to use a keyword as a collection or attribute name. If a collection or attribute need to have the same name as a keyword, the collection or attribute name needs to be quoted."),(0,r.kt)("p",null,"Keywords are case-insensitive, meaning they can be specified in lower, upper, or mixed case in queries. In this documentation, all keywords are written in upper case to make them distinguishable from other query parts."),(0,r.kt)("p",null,"There are a few more keywords in addition to the higher-level operation keywords. Additional keywords may be added in future versions of C8."),(0,r.kt)("p",null,"The complete list of keywords is currently:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"ALL"),(0,r.kt)("li",{parentName:"ul"},"AND"),(0,r.kt)("li",{parentName:"ul"},"ANY"),(0,r.kt)("li",{parentName:"ul"},"ASC"),(0,r.kt)("li",{parentName:"ul"},"COLLECT"),(0,r.kt)("li",{parentName:"ul"},"DESC"),(0,r.kt)("li",{parentName:"ul"},"DISTINCT"),(0,r.kt)("li",{parentName:"ul"},"FALSE"),(0,r.kt)("li",{parentName:"ul"},"FILTER"),(0,r.kt)("li",{parentName:"ul"},"FOR"),(0,r.kt)("li",{parentName:"ul"},"GRAPH"),(0,r.kt)("li",{parentName:"ul"},"IN"),(0,r.kt)("li",{parentName:"ul"},"INBOUND"),(0,r.kt)("li",{parentName:"ul"},"INSERT"),(0,r.kt)("li",{parentName:"ul"},"INTO"),(0,r.kt)("li",{parentName:"ul"},"LET"),(0,r.kt)("li",{parentName:"ul"},"LIMIT"),(0,r.kt)("li",{parentName:"ul"},"NONE"),(0,r.kt)("li",{parentName:"ul"},"NOT"),(0,r.kt)("li",{parentName:"ul"},"NULL"),(0,r.kt)("li",{parentName:"ul"},"OR"),(0,r.kt)("li",{parentName:"ul"},"OUTBOUND"),(0,r.kt)("li",{parentName:"ul"},"REMOVE"),(0,r.kt)("li",{parentName:"ul"},"REPLACE"),(0,r.kt)("li",{parentName:"ul"},"RETURN"),(0,r.kt)("li",{parentName:"ul"},"SHORTEST_PATH"),(0,r.kt)("li",{parentName:"ul"},"SORT"),(0,r.kt)("li",{parentName:"ul"},"TRUE"),(0,r.kt)("li",{parentName:"ul"},"UPDATE"),(0,r.kt)("li",{parentName:"ul"},"UPSERT"),(0,r.kt)("li",{parentName:"ul"},"WITH")),(0,r.kt)("h2",{id:"names"},"Names"),(0,r.kt)("p",null,"In general, names are used to identify objects (collections, attributes, variables, and functions) in C8QL queries."),(0,r.kt)("p",null,"The maximum supported length of any name is 64 bytes. Names in C8QL are always case-sensitive."),(0,r.kt)("p",null,"Keywords must not be used as names. If a reserved keyword should be used as a name, the name must be enclosed in backticks or forward ticks. Enclosing a name in backticks or forward ticks makes it possible to use otherwise reserved keywords as names. An example for this is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"FOR f IN `filter`\n  RETURN f.`sort`\n")),(0,r.kt)("p",null,"Due to the backticks, ",(0,r.kt)("em",{parentName:"p"},"filter")," and ",(0,r.kt)("em",{parentName:"p"},"sort")," are interpreted as names and not as keywords here."),(0,r.kt)("p",null,"The example can alternatively written as:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"FOR f IN \xb4filter\xb4\n  RETURN f.\xb4sort\xb4\n")),(0,r.kt)("h2",{id:"collection-names"},"Collection Names"),(0,r.kt)("p",null,"Collection names can be used in queries as they are. If a collection happens to have the same name as a keyword, the name must be enclosed in backticks."),(0,r.kt)("p",null,"Refer to the ",(0,r.kt)("a",{parentName:"p",href:"/docs/references/naming-conventions"},"Naming Conventions")," about collection naming conventions."),(0,r.kt)("p",null,"C8QL currently has a limit of up to 256 collections used in one C8QL query. This limit applies to the sum of all involved document and edge collections."),(0,r.kt)("h2",{id:"attribute-names"},"Attribute Names"),(0,r.kt)("p",null,"When referring to attributes of documents from a collection, the fully qualified attribute name must be used. This is because multiple collections with ambiguous attribute names may be used in a query.  To avoid any ambiguity, it is not allowed to refer to an unqualified attribute name."),(0,r.kt)("p",null,"Please refer to the ",(0,r.kt)("a",{parentName:"p",href:"/docs/references/naming-conventions"},"Naming Conventions")," for more information about the attribute naming conventions."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  FOR f IN friends\n    FILTER u.active == true && f.active == true && u.id == f.userId\n    RETURN u.name\n")),(0,r.kt)("p",null,"In the above example, the attribute names ",(0,r.kt)("em",{parentName:"p"},"active"),", ",(0,r.kt)("em",{parentName:"p"},"name"),", ",(0,r.kt)("em",{parentName:"p"},"id"),", and ",(0,r.kt)("em",{parentName:"p"},"userId")," are qualified using the collection names they belong to (",(0,r.kt)("em",{parentName:"p"},"u")," and ",(0,r.kt)("em",{parentName:"p"},"f")," respectively)."),(0,r.kt)("h2",{id:"variable-names"},"Variable Names"),(0,r.kt)("p",null,"C8QL allows the user to assign values to additional variables in a query.  All variables that are assigned a value must have a name that is unique within the context of the query. Variable names must be different from the names of any collection name used in the same query."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'FOR u IN users\n  LET friends = u.friends\n  RETURN { "name" : u.name, "friends" : friends }\n')),(0,r.kt)("p",null,"In the above query, ",(0,r.kt)("em",{parentName:"p"},"users")," is a collection name, and both ",(0,r.kt)("em",{parentName:"p"},"u")," and ",(0,r.kt)("em",{parentName:"p"},"friends")," are variable names. This is because the ",(0,r.kt)("em",{parentName:"p"},"FOR")," and ",(0,r.kt)("em",{parentName:"p"},"LET")," operations need target variables to store their intermediate results."),(0,r.kt)("p",null,"Allowed characters in variable names are the letters ",(0,r.kt)("em",{parentName:"p"},"a")," to ",(0,r.kt)("em",{parentName:"p"},"z")," (both in lower and upper case), the numbers ",(0,r.kt)("em",{parentName:"p"},"0")," to ",(0,r.kt)("em",{parentName:"p"},"9"),", the underscore (",(0,r.kt)("em",{parentName:"p"},"__) symbol and the dollar ("),"$_) sign. A variable name must not start with a number. If a variable name starts with the underscore character, the underscore must be followed by least one letter (a-z or A-Z) or digit (0-9)."),(0,r.kt)("p",null,"The dollar sign can be used only as the very first character in a variable name."))}p.isMDXComponent=!0}}]);