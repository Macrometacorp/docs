"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[52262],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(r),m=o,y=u["".concat(l,".").concat(m)]||u[m]||d[m]||a;return r?n.createElement(y,i(i({ref:t},p),{},{components:r})):n.createElement(y,i({ref:t},p))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var c=2;c<a;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},39188:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var n=r(87462),o=(r(67294),r(3905));const a={sidebar_position:50,title:"Primary Sort Order"},i=void 0,s={unversionedId:"search/views/primary-sort-order",id:"search/views/primary-sort-order",title:"Primary Sort Order",description:"When you create a search view, you can choose a primary sort order for each uniquely named attribute, enabling better optimization for iterated C8QL queries that sort by one or more attributes. If the fields match the sorting directions, the search view can read data from the index without a sorting operation.",source:"@site/docs/search/views/primary-sort-order.md",sourceDirName:"search/views",slug:"/search/views/primary-sort-order",permalink:"/docs/search/views/primary-sort-order",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/search/views/primary-sort-order.md",tags:[],version:"current",sidebarPosition:50,frontMatter:{sidebar_position:50,title:"Primary Sort Order"},sidebar:"defaultSidebar",previous:{title:"Integration",permalink:"/docs/search/views/integration"},next:{title:"Optional Properties",permalink:"/docs/search/views/optional-properties"}},l={},c=[],p={toc:c};function d(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"When you create a search view, you can choose a primary sort order for each uniquely named attribute, enabling better optimization for iterated C8QL queries that sort by one or more attributes. If the fields match the sorting directions, the search view can read data from the index without a sorting operation. "),(0,o.kt)("p",null,"To customize the primary sort order, you must create the search view with HTTP or JavaScript API. You cannot change the ",(0,o.kt)("inlineCode",{parentName:"p"},"primarySort")," option after creating a search view. "),(0,o.kt)("p",null,"The following example shows a search view definition paired with a C8QL query."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Search view definition:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "links": {\n    "coll1": {\n      "fields": {\n        "text": {\n        }\n      }\n    },\n    "coll2": {\n      "fields": {\n        "text": {\n      }\n    }\n  },\n  "primarySort": [\n    {\n      "field": "text",\n      "direction": "asc"\n    }\n  ]\n}\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"C8QL query:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"FOR doc IN viewName\n  SORT doc.text\n  RETURN doc\n")),(0,o.kt)("p",null,"The following examples show two alternative execution plans."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Without a sorted index:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"Execution plan:\n Id   NodeType            Est.   Comment\n  1   SingletonNode          1   * ROOT\n  2   EnumerateViewNode      1     - FOR doc IN viewName   /* view query */\n  3   CalculationNode        1       - LET #1 = doc.`val`   /* attribute expression */\n  4   SortNode               1       - SORT #1 ASC   /* sorting strategy: standard */\n  5   ReturnNode             1       - RETURN doc\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"With a primary sort order index:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"Execution plan:\n Id   NodeType            Est.   Comment\n  1   SingletonNode          1   * ROOT\n  2   EnumerateViewNode      1     - FOR doc IN viewName SORT doc.`val` ASC   /* view query */\n  5   ReturnNode             1       - RETURN doc\n")),(0,o.kt)("p",null,"To define multiple sort attributes, add sub-objects to the ",(0,o.kt)("inlineCode",{parentName:"p"},"primarySort")," array. For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'  "primarySort": [\n    {\n      "field": "date",\n      "direction": "desc"\n    },\n    {\n      "field": "text",\n      "direction": "asc"\n    }\n  ]\n')),(0,o.kt)("p",null,"In this example, we optimize a search view query to sort by text and by descending date (",(0,o.kt)("inlineCode",{parentName:"p"},"SORT doc.date DESC, doc.text"),"). Priority is given to the first field, so queries that sort by text only are ineligible (",(0,o.kt)("inlineCode",{parentName:"p"},"SORT doc.text"),"). This is conceptually similar to a skiplist index, except the search view index does not provide inverted sorting directions (",(0,o.kt)("inlineCode",{parentName:"p"},"SORT doc.date, doc.text DESC"),")."))}d.isMDXComponent=!0}}]);