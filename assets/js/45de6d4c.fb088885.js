"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[52199],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i=a.createContext({}),p=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(i.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),d=p(t),m=o,y=d["".concat(i,".").concat(m)]||d[m]||u[m]||s;return t?a.createElement(y,l(l({ref:n},c),{},{components:t})):a.createElement(y,l({ref:n},c))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var s=t.length,l=new Array(s);l[0]=d;var r={};for(var i in n)hasOwnProperty.call(n,i)&&(r[i]=n[i]);r.originalType=e,r.mdxType="string"==typeof e?e:o,l[1]=r;for(var p=2;p<s;p++)l[p]=t[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},85162:(e,n,t)=>{t.d(n,{Z:()=>l});var a=t(67294),o=t(34334);const s="tabItem_Ymn6";function l(e){let{children:n,hidden:t,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(s,l),hidden:t},n)}},65488:(e,n,t)=>{t.d(n,{Z:()=>m});var a=t(87462),o=t(67294),s=t(34334),l=t(72389),r=t(67392),i=t(7094),p=t(12466);const c="tabList__CuJ",u="tabItem_LNqP";function d(e){const{lazy:n,block:t,defaultValue:l,values:d,groupId:m,className:y}=e,v=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=d??v.map((e=>{let{props:{value:n,label:t,attributes:a}}=e;return{value:n,label:t,attributes:a}})),T=(0,r.l)(k,((e,n)=>e.value===n.value));if(T.length>0)throw new Error(`Docusaurus error: Duplicate values "${T.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const _=null===l?l:l??v.find((e=>e.props.default))?.props.value??v[0].props.value;if(null!==_&&!k.some((e=>e.value===_)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${_}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:h,setTabGroupChoices:E}=(0,i.U)(),[g,b]=(0,o.useState)(_),C=[],{blockElementScrollPositionUntilNextRender:f}=(0,p.o5)();if(null!=m){const e=h[m];null!=e&&e!==g&&k.some((n=>n.value===e))&&b(e)}const L=e=>{const n=e.currentTarget,t=C.indexOf(n),a=k[t].value;a!==g&&(f(n),b(a),null!=m&&E(m,String(a)))},N=e=>{let n=null;switch(e.key){case"ArrowRight":{const t=C.indexOf(e.currentTarget)+1;n=C[t]??C[0];break}case"ArrowLeft":{const t=C.indexOf(e.currentTarget)-1;n=C[t]??C[C.length-1];break}}n?.focus()};return o.createElement("div",{className:(0,s.Z)("tabs-container",c)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":t},y)},k.map((e=>{let{value:n,label:t,attributes:l}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:g===n?0:-1,"aria-selected":g===n,key:n,ref:e=>C.push(e),onKeyDown:N,onFocus:L,onClick:L},l,{className:(0,s.Z)("tabs__item",u,l?.className,{"tabs__item--active":g===n})}),t??n)}))),n?(0,o.cloneElement)(v.filter((e=>e.props.value===g))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},v.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==g})))))}function m(e){const n=(0,l.Z)();return o.createElement(d,(0,a.Z)({key:String(n)},e))}},41193:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>p,toc:()=>u});var a=t(87462),o=(t(67294),t(3905)),s=t(65488),l=t(85162);const r={title:"Using Rest APIs",sidebar_position:50},i=void 0,p={unversionedId:"collections/keyvalue/tutorials/using-rest-api",id:"collections/keyvalue/tutorials/using-rest-api",title:"Using Rest APIs",description:"For the following examples, assume these credentials:",source:"@site/docs/collections/keyvalue/tutorials/using-rest-api.md",sourceDirName:"collections/keyvalue/tutorials",slug:"/collections/keyvalue/tutorials/using-rest-api",permalink:"/docs/collections/keyvalue/tutorials/using-rest-api",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/collections/keyvalue/tutorials/using-rest-api.md",tags:[],version:"current",sidebarPosition:50,frontMatter:{title:"Using Rest APIs",sidebar_position:50},sidebar:"defaultSidebar",previous:{title:"Key-Value Store Stream",permalink:"/docs/collections/keyvalue/key-value-store-stream"},next:{title:"Bulk Update with RestQL",permalink:"/docs/collections/keyvalue/tutorials/bulk-update-restql"}},c={},u=[{value:"API Browser",id:"api-browser",level:2},{value:"Connect to GDN",id:"connect-to-gdn",level:2},{value:"Create Collection",id:"create-collection",level:2},{value:"Insert KV Pairs",id:"insert-kv-pairs",level:2},{value:"Get Value",id:"get-value",level:2},{value:"Get Count",id:"get-count",level:2},{value:"Update Value",id:"update-value",level:2},{value:"Delete Value",id:"delete-value",level:2},{value:"Get Collections",id:"get-collections",level:2},{value:"Delete Collections",id:"delete-collections",level:2},{value:"Complete example",id:"complete-example",level:2}],d={toc:u};function m(e){let{components:n,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},d,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"For the following examples, assume these credentials:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Tenant name: ",(0,o.kt)("a",{parentName:"li",href:"mailto:nemo@nautilus.com"},"nemo@nautilus.com")),(0,o.kt)("li",{parentName:"ul"},"Password: xxxxxx")),(0,o.kt)("h2",{id:"api-browser"},"API Browser"),(0,o.kt)("p",null,"Your main tool when working with REST APIs is the REST API browser available in the ",(0,o.kt)("a",{parentName:"p",href:"https://play.paas.macrometa.io"},"GDN")," GUI. From there, you can execute various REST APIs and see exactly what the inputs and outputs are."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"GDN API Browser",src:t(25369).Z,width:"1059",height:"807"})),(0,o.kt)("h2",{id:"connect-to-gdn"},"Connect to GDN"),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import requests\nimport json\n\n# Constants\n\nURL = "api-play.paas.macrometa.io"\nHTTP_URL = "https://{}".format(URL)\nEMAIL = "nemo@nautilus.com"\nPASSWORD = "xxxxxx"\nFABRIC = "_system"\nAUTH_TOKEN = "bearer "\n\n# Create HTTPS session\n\nurl = "{}/_open/auth".format(HTTP_URL)\npayload = {\n    \'email\':EMAIL,\n    \'password\':PASSWORD\n    }\nheaders = {\n    \'content-type\': \'application/json\'\n    }\n\nresponse = requests.post(url, data = json.dumps(payload), headers = headers)\n\nif response.status_code == 200:\n    resp_body = json.loads(response.text)\n    AUTH_TOKEN += resp_body["jwt"]\n    TENANT = resp_body["tenant"]\nelse:\n    raise Exception("Error while getting auth token. Code:{}, Reason:{}".format(response.status_code,response.reason))\n\n\nsession = requests.session()\nsession.headers.update({"content-type": \'application/json\'})\nsession.headers.update({"authorization": AUTH_TOKEN})\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'class APIRequest {\n_headers = {\nAccept: "application/json",\n"Content-Type": "application/json",\n};\n\nconstructor(url) {\nthis._url = url;\n}\n\nlogin(email, password) {\nconst endpoint = "/_open/auth";\n\nconst self = this;\n\nreturn new Promise(function (resolve, reject) {\nself\n.req(endpoint, {\nbody: { email, password },\nmethod: "POST",\n})\n.then(({ jwt, ...data }) => {\nself._headers.authorization = bearer ${jwt};\nresolve(data);\n})\n.catch(reject);\n});\n}\n\n_handleResponse(response, resolve, reject) {\nif (response.ok) {\nresolve(response.json());\n} else {\nreject(response);\n}\n}\n\nreq(endpoint, { body, ...options } = {}) {\nconst self = this;\nreturn new Promise(function (resolve, reject) {\nfetch(self._url + endpoint, {\nheaders: self._headers,\nbody: body ? JSON.stringify(body) : undefined,\n...options,\n}).then((response) => self._handleResponse(response, resolve, reject));\n});\n}\n}\nconst EMAIL = "nemo@nautilus.com";\nconst PASSWORD = "xxxxxx";\nconst HTTP_URL = "https://api-play.paas.macrometa.io";\n\nconst COLLECTION_NAME = "students";\n\nconst run = async function () {\ntry {\nconst connection = new APIRequest(HTTP_URL);\n\n/* -------------------- Log in (nemo@nautilus.com/xxxxxxx) -------------------- */\n\nawait connection.login(EMAIL, PASSWORD);\n\nconsole.log("Login Successfully using", EMAIL);\n')))),(0,o.kt)("h2",{id:"create-collection"},"Create Collection"),(0,o.kt)("p",null,"Create a KV collection."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Create a collection\n\n  COLLECTION_NAME = "students"\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME\n\n  resp = session.post(url, data = json.dumps(payload))\n  resp = resp.json()\n  if \'error\' in resp and resp[\'error\']:\n      print("ERROR: " + resp[\'errorMessage\'])\n  else:\n      print("\\nCollection Created: ", resp["name"])\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'/* -------------------------- Create collection ------------------------- */\n  \n  const collection = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}`,\n  {\n  method: "POST",\n  }\n  );\n  \n  console.log("COLLECTION CREATED SUCCESSFULLY", collection);\n')))),(0,o.kt)("h2",{id:"insert-kv-pairs"},"Insert KV Pairs"),(0,o.kt)("p",null,"Insert Key Value pairs into collection."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Insert KV pairs into a collection\n  data = [\n    {\n      "_key": "John",\n      "value": "Science",\n      "expireAt": 0\n    },\n    {\n      "_key": "Alice",\n      "value": "Maths",\n      "expireAt": 0\n    },\n    {\n      "_key": "Alex",\n      "value": "Physics",\n      "expireAt": 0\n    },\n    {\n      "_key": "Monika",\n      "value": "Chemistry",\n      "expireAt": 0\n    }\n  ]\n\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/value"\n  print(url)\n  resp = session.put(url, data = json.dumps(data))\n  print("\\nMultiple Documents Inserted: ", resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'/* ---------------------------- Insert key-value pairs ---------------------------- */\n  \n  const document = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value`,\n  {\n  body: [\n  {\n  "_key": "John",\n  "value": "Science",\n  "expireAt": 0\n  },\n  {\n  "_key": "Alice",\n  "value": "Maths",\n  "expireAt": 0\n  },\n  {\n  "_key": "Alex",\n  "value": "Physics",\n  "expireAt": 0\n  },\n  {\n  "_key": "Monika",\n  "value": "Chemistry",\n  "expireAt": 0\n  }\n  ]\n  ,\n  method: "PUT",\n  }\n  );\n  \n  console.log("KV PAIRS INSERTED SUCCESSFULLY", document);\n')))),(0,o.kt)("h2",{id:"get-value"},"Get Value"),(0,o.kt)("p",null,"Get value for a given key."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Get value for a key\n\n  KEY = "Monika"\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME + "/value/" + KEY\n  resp = session.get(url)\n  print("\\nDocument with specified Key is: ",resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'/* ----------------------------- Get value for a Key ----------------------------- */\n  let key = "Monika";\n  const readVal = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value/${key}`\n  );\n  \n  console.log("VALUE FOR SPECIFIED KEY IS", readVal);\n')))),(0,o.kt)("h2",{id:"get-count"},"Get Count"),(0,o.kt)("p",null,"Get size of the kv collection."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Get collection count\n\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME + "/count"\n  resp = session.get(url)\n  print("\\nNumber of kv pairs in your collection: ",resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  /* ---------------------------- Get collection count ---------------------------- */\n  \n  const collCount = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/count`,\n  {\n  method: "GET",\n  }\n  );\n  \n  console.log("COLLECTION COUNT", collCount);\n')))),(0,o.kt)("h2",{id:"update-value"},"Update Value"),(0,o.kt)("p",null,"Update value for a given key in the collection."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Update value for a key\n  data =  {\n      "_key": "Monika",\n      "value": "Biology",\n      "expireAt": 0\n    }\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/value"\n  resp = session.put(url, data = json.dumps(data))\n  print("\\nDocument Updated: ", resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  /* ----------------------------- Update value for a key ----------------------------- */\n  \n  const updateValue = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value`,\n  {\n  body: [\n  {\n  "_key": "John",\n  "value": "Biology",\n  "expireAt": 0\n  }\n  ]\n  ,\n  method: "PUT",\n  }\n  );\n  \n  console.log("KV PAIR UPDATED SUCCESSFULLY", updateValue);\n')))),(0,o.kt)("h2",{id:"delete-value"},"Delete Value"),(0,o.kt)("p",null,"Delete value for a given key."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Delete value for a Key\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/value/" + KEY\n  resp = session.delete(url)\n  print("\\nDocument with specified Key Deleted: ", resp.text)\n\n  # Delete value for multiple Keys\n  data = ["Alex", "Alice", "John"]\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/values"\n  resp = session.delete(url, data = json.dumps(data))\n  print("\\nDocument with specified Key Deleted: ", resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  /* --------------------------- Delete value for a key ---------------------------- */\n  \n  const deletedValue = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value/${key}`,\n  { method: "DELETE" }\n  );\n')))),(0,o.kt)("h2",{id:"get-collections"},"Get Collections"),(0,o.kt)("p",null,"Get collections."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Get collections\n  url = HTTP_URL + "/_api/kv"\n  resp = session.get(url)\n  print("\\nCollections : ",resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"")))),(0,o.kt)("h2",{id:"delete-collections"},"Delete Collections"),(0,o.kt)("p",null,"Delete collection."),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'  # Delete collection\n\n  url = HTTP_URL + "/_api/kv/" + COLLECTION_NAME \n  resp = session.delete(url)\n  print("\\nCollection Deleted: ", resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  /* --------------------------- Delete collection ---------------------------- */\n  const deletedCollection = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}`,\n  { method: "DELETE" }\n  );\n  \n  console.log("COLLECTION DELETED SUCCESSFULLY", deletedCollection);\n  } catch (e) {\n  console.error(e);\n  }\n  };\n')))),(0,o.kt)("h2",{id:"complete-example"},"Complete example"),(0,o.kt)(s.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import requests\nimport json\n\n# Constants\n\nURL = "api-play.paas.macrometa.io"\nHTTP_URL = f"https://{URL}"\nEMAIL = "nemo@nautilus.com"\nPASSWORD = "xxxxxx"\nFABRIC = "_system"\nAUTH_TOKEN = "bearer "\nCOLLECTION_NAME = "students"\n\n# Create HTTPS session\n\nurl = f"{HTTP_URL}/_open/auth"\npayload = {\n      \'email\':EMAIL,\n      \'password\':PASSWORD\n      }\nheaders = {\n      \'content-type\': \'application/json\'\n      }\nresponse = requests.post(url, data = json.dumps(payload), headers = headers)\nif response.status_code == 200:\n      resp_body = json.loads(response.text)\n      AUTH_TOKEN += resp_body["jwt"]\n      TENANT = resp_body["tenant"]\nelse:\n      raise Exception(f"Error while getting auth token. Code:{response.status_code}, Reason:{response.reason}")\nsession = requests.session()\nsession.headers.update({"content-type": \'application/json\'})\nsession.headers.update({"authorization": AUTH_TOKEN})\n\n# Get list of all regions\n\nurl = HTTP_URL + "/_api/datacenter/all"\ndcl_resp = session.get(url)\ndcl_list = json.loads(dcl_resp.text)\nregions = []\nfor dcl in dcl_list:\n      dcl_url = dcl[\'tags\'][\'url\']\n      regions.append(dcl_url)\nprint("\\nList of Regions: ",regions)\n\n# Create a collection\n\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME\nresp = session.post(url, data = json.dumps(payload))\nresp = json.loads(resp.text)\nif \'error\' in resp and resp[\'error\']:\n      print("ERROR: " + resp[\'errorMessage\'])\nelse:\n      print("\\nCollection Created: ", resp["name"])\n\n# Insert KV pairs in a Collection\n\ndata = [\n    {\n      "_key": "John",\n      "value": "Science",\n      "expireAt": 0\n    },\n    {\n      "_key": "Alice",\n      "value": "Maths",\n      "expireAt": 0\n    },\n    {\n      "_key": "Alex",\n      "value": "Physics",\n      "expireAt": 0\n    },\n    {\n      "_key": "Monika",\n      "value": "Chemistry",\n      "expireAt": 0\n    }\n  ]\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/value"\nprint(url)\nresp = session.put(url, data = json.dumps(data))\nprint("\\nMultiple Documents Inserted: ", resp.text)\n\n# Get value for a given key\n\nKEY = "Monika"\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME + "/value/" + KEY\nresp = session.get(url)\nprint("\\nDocument with specified Key is: ",resp.text)\n\n# Get collection count\n\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME + "/count"\nresp = session.get(url)\nprint("\\nNumber of kv pairs in your collection: ",resp.text)\n\n# Update value for a key\n\ndata =  {\n      "_key": "Monika",\n      "value": "Biology",\n      "expireAt": 0\n    }\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/value"\nresp = session.put(url, data = json.dumps(data))\nprint("\\nDocument Updated: ", resp.text)\n\n# Delete value for a key\n\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/value/" + KEY\nresp = session.delete(url)\nprint("\\nDocument with specified Key Deleted: ", resp.text)\n\n# Delete value for multiple keys\n\ndata = ["Alex", "Alice", "John"]\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME +"/values"\nresp = session.delete(url, data = json.dumps(data))\nprint("\\nDocument with specified Key Deleted: ", resp.text)\n\n# Get collections\n\nurl = HTTP_URL + "/_api/kv"\nresp = session.get(url)\nprint("\\nCollections : ",resp.text)\n\n# Delete collection\n\nurl = HTTP_URL + "/_api/kv/" + COLLECTION_NAME\nresp = session.delete(url)\nprint("\\nCollection Deleted: ", resp.text)\n'))),(0,o.kt)(l.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'class APIRequest {\n  _headers = {\n  Accept: "application/json",\n  "Content-Type": "application/json",\n  };\n  \n  constructor(url) {\n  this._url = url;\n  }\n  \n  login(email, password) {\n  const endpoint = "/_open/auth";\n  \n  const self = this;\n  \n  return new Promise(function (resolve, reject) {\n  self\n  .req(endpoint, {\n  body: { email, password },\n  method: "POST",\n  })\n  .then(({ jwt, ...data }) => {\n  self._headers.authorization = bearer ${jwt};\n  resolve(data);\n  })\n  .catch(reject);\n  });\n  }\n  \n  _handleResponse(response, resolve, reject) {\n  if (response.ok) {\n  resolve(response.json());\n  } else {\n  reject(response);\n  }\n  }\n  \n  req(endpoint, { body, ...options } = {}) {\n  const self = this;\n  return new Promise(function (resolve, reject) {\n  fetch(self._url + endpoint, {\n  headers: self._headers,\n  body: body ? JSON.stringify(body) : undefined,\n  ...options,\n  }).then((response) => self._handleResponse(response, resolve, reject));\n  });\n  }\n  }\n  const EMAIL = "nemo@nautilus.com";\n  const PASSWORD = "xxxxxx";\n  const HTTP_URL = "https://api-play.paas.macrometa.io";\n  \n  const COLLECTION_NAME = "students";\n  \n  const run = async function () {\n  try {\n  const connection = new APIRequest(HTTP_URL);\n  \n  /* -------------------- Log in (nemo@nautilus.com/xxxxxxx) -------------------- */\n  \n  await connection.login(EMAIL, PASSWORD);\n  \n  console.log("Login Successfully using", EMAIL);\n  \n  /* -------------------------- Create collection ------------------------- */\n  \n  const collection = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}`,\n  {\n  method: "POST",\n  }\n  );\n  \n  console.log("COLLECTION CREATED SUCCESSFULLY", collection);\n  \n  /* ---------------------------- Insert key-value pairs ---------------------------- */\n  \n  const document = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value`,\n  {\n  body: [\n  {\n  "_key": "John",\n  "value": "Science",\n  "expireAt": 0\n  },\n  {\n  "_key": "Alice",\n  "value": "Maths",\n  "expireAt": 0\n  },\n  {\n  "_key": "Alex",\n  "value": "Physics",\n  "expireAt": 0\n  },\n  {\n  "_key": "Monika",\n  "value": "Chemistry",\n  "expireAt": 0\n  }\n  ]\n  ,\n  method: "PUT",\n  }\n  );\n  \n  console.log("KV PAIRS INSERTED SUCCESSFULLY", document);\n  \n  /* ----------------------------- Get value for a Key ----------------------------- */\n  let key = "Monika";\n  const readVal = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value/${key}`\n  );\n  \n  console.log("VALUE FOR SPECIFIED KEY IS", readVal);\n  \n  /* ---------------------------- Get collection count ---------------------------- */\n  \n  const collCount = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/count`,\n  {\n  method: "GET",\n  }\n  );\n  \n  console.log("COLLECTION COUNT", collCount);\n  \n  /* ----------------------------- Update value for a key ----------------------------- */\n  \n  const updateValue = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value`,\n  {\n  body: [\n  {\n  "_key": "John",\n  "value": "Biology",\n  "expireAt": 0\n  }\n  ]\n  ,\n  method: "PUT",\n  }\n  );\n  \n  console.log("KV PAIR UPDATED SUCCESSFULLY", updateValue);\n  \n    /* --------------------------- Delete value for a key ---------------------------- */\n  const deletedValue = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}/value/${key}`,\n  { method: "DELETE" }\n  );\n\n  \n  /* --------------------------- Delete collection ---------------------------- */\n  const deletedCollection = await connection.req(\n  `/_fabric/_system/_api/kv/${COLLECTION_NAME}`,\n  { method: "DELETE" }\n  );\n  \n  console.log("COLLECTION DELETED SUCCESSFULLY", deletedCollection);\n  } catch (e) {\n  console.error(e);\n  }\n  };\n  \n  run();\n')))))}m.isMDXComponent=!0},25369:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/gdn-api-browser-a97ea76030a8c372c2254418f1e67c27.png"}}]);