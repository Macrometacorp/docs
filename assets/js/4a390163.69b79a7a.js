"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[65084],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>d});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=u(r),d=a,h=m["".concat(l,".").concat(d)]||m[d]||c[d]||o;return r?n.createElement(h,i(i({ref:t},p),{},{components:r})):n.createElement(h,i({ref:t},p))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var u=2;u<o;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},91733:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>u});var n=r(87462),a=(r(67294),r(3905));const o={sidebar_position:4,title:"FILTER"},i=void 0,s={unversionedId:"queryworkers/c8ql/operations/filter",id:"queryworkers/c8ql/operations/filter",title:"FILTER",description:"The FILTER statement can be used to restrict the results to elements that match an arbitrary logical condition.",source:"@site/docs/queryworkers/c8ql/operations/filter.md",sourceDirName:"queryworkers/c8ql/operations",slug:"/queryworkers/c8ql/operations/filter",permalink:"/docs/queryworkers/c8ql/operations/filter",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/queryworkers/c8ql/operations/filter.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"FILTER"},sidebar:"defaultSidebar",previous:{title:"RETURN",permalink:"/docs/queryworkers/c8ql/operations/return"},next:{title:"SEARCH",permalink:"/docs/queryworkers/c8ql/operations/search"}},l={},u=[{value:"General syntax",id:"general-syntax",level:2},{value:"Order of operations",id:"order-of-operations",level:2}],p={toc:u};function c(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," statement can be used to restrict the results to elements that match an arbitrary logical condition."),(0,a.kt)("h2",{id:"general-syntax"},"General syntax"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"FILTER expression\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"expression")," must be a condition that evaluates to either ",(0,a.kt)("em",{parentName:"p"},"false")," or ",(0,a.kt)("em",{parentName:"p"},"true"),". If the condition result is false, the current element is skipped, so it will not be processed further and not be part of the result. If the condition is true, the current element is not skipped and can be further processed."),(0,a.kt)("p",null,"See ",(0,a.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/operators"},"Operators")," for a list of comparison operators, logical operators etc. that you can use in conditions."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  FILTER u.active == true && u.age < 39\n  RETURN u\n")),(0,a.kt)("p",null,"It is allowed to specify multiple ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," statements in a query, even in the same block. If multiple ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," statements are used, their results will be combined with a logical AND, meaning all filter conditions must be true to include an element."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  FILTER u.active == true\n  FILTER u.age < 39\n  RETURN u\n")),(0,a.kt)("p",null,"In the above example, all array elements of ",(0,a.kt)("em",{parentName:"p"},"users"),"  that have an attribute ",(0,a.kt)("em",{parentName:"p"},"active")," with value ",(0,a.kt)("em",{parentName:"p"},"true")," and that have an attribute ",(0,a.kt)("em",{parentName:"p"},"age")," with a value less than ",(0,a.kt)("em",{parentName:"p"},"39")," (including ",(0,a.kt)("em",{parentName:"p"},"null")," ones) will be included in the result. All other elements of ",(0,a.kt)("em",{parentName:"p"},"users")," will be skipped and not be included in the result produced by ",(0,a.kt)("inlineCode",{parentName:"p"},"RETURN"),". Refer to ",(0,a.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/queries-null-attributes"},"Queries with Null Attributes")," for a description of the impact of non-existent or null attributes."),(0,a.kt)("h2",{id:"order-of-operations"},"Order of operations"),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The positions of ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," statements can influence the result of a query. There are 16 active users in the ",(0,a.kt)("a",{parentName:"p",href:"/docs/queryworkers/c8ql/examples/#example-data"},"test data")," for instance:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  FILTER u.active == true\n  RETURN u\n")),(0,a.kt)("p",null,"We can limit the result set to 5 users at most:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  FILTER u.active == true\n  LIMIT 5\n  RETURN u\n")),(0,a.kt)("p",null,"This may return the user documents of Jim, Diego, Anthony, Michael and Chloe for instance. Which ones are returned is undefined, since there is no ",(0,a.kt)("inlineCode",{parentName:"p"},"SORT")," statement to ensure a particular order. If we add a second ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," statement to only return women."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'FOR u IN users\n  FILTER u.active == true\n  LIMIT 5\n  FILTER u.gender == "f"\n  RETURN u\n')),(0,a.kt)("p",null,"This might just return the Chloe document, because the ",(0,a.kt)("inlineCode",{parentName:"p"},"LIMIT")," is applied before the second ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER"),". No more than 5 documents arrive at the second ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," block, and not all of them fulfill the gender criterion, eventhough there are more than 5 active female users in the collection. A more deterministic result can be achieved by adding a ",(0,a.kt)("inlineCode",{parentName:"p"},"SORT")," block:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'FOR u IN users\n  FILTER u.active == true\n  SORT u.age ASC\n  LIMIT 5\n  FILTER u.gender == "f"\n  RETURN u\n')),(0,a.kt)("p",null,"This will return the users Mariah and Mary. If sorted by age in ",(0,a.kt)("em",{parentName:"p"},"DESC")," order, then the Sophia, Emma and Madison documents are returned. A ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," after a ",(0,a.kt)("inlineCode",{parentName:"p"},"LIMIT")," is not very common however, and you probably want such a query instead:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'FOR u IN users\n  FILTER u.active == true AND u.gender == "f"\n  SORT u.age ASC\n  LIMIT 5\n  RETURN u\n')),(0,a.kt)("p",null,"The significance of where ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," blocks are placed allows that this single keyword can assume the roles of two SQL keywords, ",(0,a.kt)("em",{parentName:"p"},"WHERE")," as well as ",(0,a.kt)("em",{parentName:"p"},"HAVING"),". C8QL's ",(0,a.kt)("inlineCode",{parentName:"p"},"FILTER")," thus works with ",(0,a.kt)("inlineCode",{parentName:"p"},"COLLECT")," aggregates the same as with any other intermediate result, document attribute etc."))}c.isMDXComponent=!0}}]);