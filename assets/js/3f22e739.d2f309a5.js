"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7460],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=p(n),m=i,f=d["".concat(s,".").concat(m)]||d[m]||c[m]||r;return n?a.createElement(f,l(l({ref:t},u),{},{components:n})):a.createElement(f,l({ref:t},u))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},13:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var a=n(87462),i=(n(67294),n(3905));const r={sidebar_position:60,title:"Fluent Bit Client"},l=void 0,o={unversionedId:"streams/kafka_on_gdn/fluent-bit-client",id:"streams/kafka_on_gdn/fluent-bit-client",title:"Fluent Bit Client",description:"Fluent Bit is an open-source and multi-platform log processor tool that aims to be a generic Swiss knife for logs processing and distribution.",source:"@site/docs/streams/kafka_on_gdn/fluent-bit-client.md",sourceDirName:"streams/kafka_on_gdn",slug:"/streams/kafka_on_gdn/fluent-bit-client",permalink:"/docs/streams/kafka_on_gdn/fluent-bit-client",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/streams/kafka_on_gdn/fluent-bit-client.md",tags:[],version:"current",sidebarPosition:60,frontMatter:{sidebar_position:60,title:"Fluent Bit Client"},sidebar:"defaultSidebar",previous:{title:"Kafka NodeJS Client",permalink:"/docs/streams/kafka_on_gdn/kafka-nodejs-client"},next:{title:"Stream Workers",permalink:"/docs/cep/"}},s={},p=[{value:"Installation",id:"installation",level:2},{value:"Prequisites",id:"prequisites",level:3},{value:"Build",id:"build",level:3},{value:"Run",id:"run",level:3},{value:"Verify",id:"verify",level:3}],u={toc:p};function c(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Fluent Bit is an open-source and multi-platform log processor tool that aims to be a generic Swiss knife for logs processing and distribution."),(0,i.kt)("p",null,"Fluent Bit works as a logging pipeline chunked into logical parts like Inputs, Parsers, Filters and Outputs. Kafka client implementation able in Output part. It means Fluent bit produces records and sends to Kafka."),(0,i.kt)("p",null,"Full Kafka plugin documentation can be found ",(0,i.kt)("a",{parentName:"p",href:"https://docs.fluentbit.io/manual/pipeline/outputs/kafka"},"here")),(0,i.kt)("p",null,"The Fluent Bit Kafka plugin is built on top of ",(0,i.kt)("inlineCode",{parentName:"p"},"libdrkafka")," ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/edenhill/librdkafka/"},"library"),"."),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("p",null,"Following are the steps for Fluent Bit installation on Ubuntu OS. The below steps will show how to build and install Fluent Bit with correct plugins and modules."),(0,i.kt)("h3",{id:"prequisites"},"Prequisites"),(0,i.kt)("p",null,"Building Fluent Bit from scratch requires installing ",(0,i.kt)("inlineCode",{parentName:"p"},"git")," and then cloning a repository from ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/fluent/fluent-bit"},"GitHub")," and checkout to the latest version."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"sudo apt update\nsudo apt install git\ngit clone https://github.com/fluent/fluent-bit.git\ngit checkout 1.8.0-pack-fixes\n")),(0,i.kt)("p",null,"Building of Fluent Bit requires other Ubuntu packages.\nFluent Bit uses CMake as it build system. The suggested procedure to prepare the build system consists on the following steps:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"sudo apt install -y build-essential\nsudo apt install -y make\nsudo apt install -y cmake\nsudo apt install -y libsasl2-dev\nsudo apt install -y bison\nsudo apt install -y flex\nsudo apt install -y libssl-dev\n")),(0,i.kt)("h3",{id:"build"},"Build"),(0,i.kt)("p",null,"Change to the ",(0,i.kt)("inlineCode",{parentName:"p"},"build")," directory inside the Fluent Bit sources and let CMake configure the project specifying where the root path is located with Kafka plugin and TLS module:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"cd fluent-bit/build\ncmake -DFLB_OUT_KAFKA=On -DFLB_TLS=On ..\nmake\n")),(0,i.kt)("h3",{id:"run"},"Run"),(0,i.kt)("p",null,"This sample uses on input ",(0,i.kt)("inlineCode",{parentName:"p"},"dummy")," plugin. It generates records that consists event time. Here is an example ",(0,i.kt)("inlineCode",{parentName:"p"},'{"@timestamp":1629229398.754061,"message":"dummy"}'),".\nOutput parameter uses ",(0,i.kt)("inlineCode",{parentName:"p"},"kafka")," plugin with name of Kafka topic and additional parameters from ",(0,i.kt)("inlineCode",{parentName:"p"},"libdrkafka")," library.\nA topic should have prefix of global either local namespace. A full topic name: ",(0,i.kt)("inlineCode",{parentName:"p"},"<c8globals or c8locals>.<my-topic>"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bin/fluent-bit \\\n    -i dummy \\\n    -o kafka \\\n    -p brokers=<my-gdn>.<my-paas>.macrometa.io:9093 \\\n    -p topics=<c8globals or c8locals>.<my-topic> \\\n    -p rdkafka.security.protocol=SASL_SSL \\\n    -p rdkafka.enable.ssl.certificate.verification=false \\\n    -p rdkafka.ssl.ca.location=<path-to-ca.cert.pem-file> \\\n    -p rdkafka.sasl.mechanism=PLAIN \\\n    -p rdkafka.sasl.username=<my-tenant>/<my-fabric> \\\n    -p rdkafka.sasl.password=token:<my-api-key or my-JWT> \\\n    -p rdkafka.client.id=fluent-bit-client \\\n    -p rdkafka.log.connection.close=false \\\n    -p rdkafka.request.required.acks=1\n")),(0,i.kt)("p",null,"Note: The full list of properties can be found ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md"},"here"),"."),(0,i.kt)("h3",{id:"verify"},"Verify"),(0,i.kt)("p",null,"Sent messages can be verified by the consumer of any java, python, node.js Kafka client."),(0,i.kt)("p",null,"Example in nodejs"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-node"},"const consumer = kafka.consumer({ groupId: '<my-group-id>' })\n\nawait consumer.connect()\nawait consumer.subscribe({ topic: '<c8globals or c8locals>.<my-topic>', fromBeginning: true })\n\nawait consumer.run({\n  eachMessage: async ({ topic, partition, message }) => {\n    console.log({\n      value: message.value.toString(),\n    })\n  }\n})\n")))}c.isMDXComponent=!0}}]);