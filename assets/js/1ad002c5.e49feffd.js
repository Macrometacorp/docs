"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[31990],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>N});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var m=n.createContext({}),u=function(e){var t=n.useContext(m),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(m.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},s=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,m=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),s=u(a),N=r,c=s["".concat(m,".").concat(N)]||s[N]||d[N]||l;return a?n.createElement(c,i(i({ref:t},p),{},{components:a})):n.createElement(c,i({ref:t},p))}));function N(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=s;var o={};for(var m in t)hasOwnProperty.call(t,m)&&(o[m]=t[m]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var u=2;u<l;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}s.displayName="MDXCreateElement"},14250:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>m,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>o,toc:()=>u});var n=a(87462),r=(a(67294),a(3905));const l={sidebar_position:120,title:"Store RDBMS Plugin"},i=void 0,o={unversionedId:"cep/store-rdbms-plugin",id:"cep/store-rdbms-plugin",title:"Store RDBMS Plugin",description:"You can use plugins in Macrometa to extend the functionality of your streams.",source:"@site/docs/cep/store-rdbms-plugin.md",sourceDirName:"cep",slug:"/cep/store-rdbms-plugin",permalink:"/docs/cep/store-rdbms-plugin",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/cep/store-rdbms-plugin.md",tags:[],version:"current",sidebarPosition:120,frontMatter:{sidebar_position:120,title:"Store RDBMS Plugin"},sidebar:"defaultSidebar",previous:{title:"Change Data Capture Plugin",permalink:"/docs/cep/change-data-capture-plugin"},next:{title:"Akamai in Macrometa",permalink:"/docs/akamai/"}},m={},u=[{value:"Create, Update, Delete (CUD)",id:"create-update-delete-cud",level:2},{value:"Parameters",id:"parameters",level:3},{value:"CUD Template",id:"cud-template",level:3},{value:"CUD Examples",id:"cud-examples",level:3},{value:"Procedure",id:"procedure",level:2},{value:"Procedure Parameters",id:"procedure-parameters",level:3},{value:"Procedure Template",id:"procedure-template",level:3},{value:"Procedure Examples",id:"procedure-examples",level:3},{value:"Query",id:"query",level:2},{value:"Query Parameters",id:"query-parameters",level:3},{value:"Query Template",id:"query-template",level:3},{value:"Query Examples",id:"query-examples",level:3},{value:"Store",id:"store",level:2},{value:"Store Parameters",id:"store-parameters",level:3},{value:"Store Template",id:"store-template",level:3},{value:"Store Examples",id:"store-examples",level:3}],p={toc:u};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"You can use plugins in Macrometa to extend the functionality of your streams."),(0,r.kt)("p",null,"The Store plugin provides persistence and retrieval of events to and from RDBMS databases like MySQL, MS SQL, PostgreSQL, H2, and Oracle. If you are using CEP as the Java/Python library, then you must also set the data source in the CEP Manager."),(0,r.kt)("p",null,"This plugin provides the following functionality:"),(0,r.kt)("h2",{id:"create-update-delete-cud"},"Create, Update, Delete (CUD)"),(0,r.kt)("p",null,"You can use SQL CUD to perform INSERT, UPDATE, and DELETE queries on data sources."),(0,r.kt)("h3",{id:"parameters"},"Parameters"),(0,r.kt)("p",null,"Insert the following parameters into the provided ",(0,r.kt)("a",{parentName:"p",href:"#template"},"template")," to create a CUD function."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Data Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,r.kt)("th",{parentName:"tr",align:null},"Optional?"),(0,r.kt)("th",{parentName:"tr",align:null},"Dynamic?"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"data-source.name"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the data source on which to run the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"query"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"The INSERT, UPDATE, or DELETE query to be performed. Format according to the relevant database type.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"parameter"),(0,r.kt)("td",{parentName:"tr",align:null},"Any"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"If ",(0,r.kt)("inlineCode",{parentName:"td"},"query")," is a parameter used as an SQL query, then you can use this field to pass CEP attributes to set parameter values.")))),(0,r.kt)("p",null,"Additionally, the ",(0,r.kt)("inlineCode",{parentName:"p"},"numRecords")," attribute (INT) indicates the number of records manipulated by the query."),(0,r.kt)("h3",{id:"cud-template"},"CUD Template"),(0,r.kt)("p",null,"Use the following template to create a CUD function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"rdbms:cud(STRING jdbc.url, STRING username, STRING password, STRING jdbc.driver.name, STRING query)\nrdbms:cud(STRING jdbc.url, STRING username, STRING password, STRING jdbc.driver.name, STRING query, STRING|BOOL|INT|DOUBLE|FLOAT|LONG parameter, STRING|BOOL|INT|DOUBLE|FLOAT|LONG ...)\n")),(0,r.kt)("h3",{id:"cud-examples"},"CUD Examples"),(0,r.kt)("p",null,"The following examples assume you have an input stream called ",(0,r.kt)("inlineCode",{parentName:"p"},"TriggerStream")," and an output stream called ",(0,r.kt)("inlineCode",{parentName:"p"},"RecordStream"),"."),(0,r.kt)("p",null,"This example query updates events from the input stream by adding a ",(0,r.kt)("inlineCode",{parentName:"p"},"numRecords")," attribute, then inserts the updated events into an output stream:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'INSERT INTO RecordStream\nSELECT numRecords \nFROM TriggerStream#rdbms:cud("jdbc:mysql://hostname:3306/MySQLDB?useSSL=false", "username", "password", "com.mysql.jdbc.Driver", "UPDATE Customers_Table SET customerName=\'abc\' where customerName=\'xyz\'");\n')),(0,r.kt)("p",null,"Make sure the stream is defined with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE STREAM TriggerStream (customerName string);\n")),(0,r.kt)("p",null,"This example query does the same thing with the addition of ",(0,r.kt)("inlineCode",{parentName:"p"},"previousName")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"changedName")," attributes to indicate the names of the input and output streams:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'INSERT INTO RecordStream\nSELECT numRecords \nFROM TriggerStream#rdbms:cud("jdbc:mysql://hostname:3306/MySQLDB?useSSL=false", "username", "password", "com.mysql.jdbc.Driver",  "UPDATE Customers_Table SET customerName=? where customerName=?", changedName, previousName);\n')),(0,r.kt)("p",null,"Make sure the stream is defined with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE STREAM TriggerStream (customerName string, changedName string, previousName string);\n")),(0,r.kt)("h2",{id:"procedure"},"Procedure"),(0,r.kt)("p",null,"You can use the Procedure function to run stored procedures and retrieve data to a stream worker."),(0,r.kt)("h3",{id:"procedure-parameters"},"Procedure Parameters"),(0,r.kt)("p",null,"Insert the following parameters into the provided ",(0,r.kt)("a",{parentName:"p",href:"#template"},"template")," to create a Procedure function."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Data Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,r.kt)("th",{parentName:"tr",align:null},"Optional?"),(0,r.kt)("th",{parentName:"tr",align:null},"Dynamic?"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"data-source.name"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the data source on which to run the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"query"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"The INSERT, UPDATE, or DELETE query to be performed. Format according to the relevant database type.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"parameter"),(0,r.kt)("td",{parentName:"tr",align:null},"Any"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"If ",(0,r.kt)("inlineCode",{parentName:"td"},"query")," is a parameter used as a SQL query, you can use this field to pass CEP attributes to set parameter values.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"attribute.definition.list"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"A comma-separated list of attributes to return with the SQL query. Each item is processed in order. Supported data types are ",(0,r.kt)("inlineCode",{parentName:"td"},"STRING"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"INT"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"LONG"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"DOUBLE"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"FLOAT"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"BOOL"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"output.parameter"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"A comma-separated list of sub-attributes to return with the SQL query. Each item is processed in order. Supported data types are ",(0,r.kt)("inlineCode",{parentName:"td"},"STRING"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"INT"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"LONG"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"DOUBLE"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"FLOAT"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"BOOL"),".")))),(0,r.kt)("p",null,"Additionally, the ",(0,r.kt)("inlineCode",{parentName:"p"},"attributeName")," attribute (any type) returns the attributes listed in the parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"attribute.definition.list"),"."),(0,r.kt)("h3",{id:"procedure-template"},"Procedure Template"),(0,r.kt)("p",null,"Use the following template to create a procedure function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"rdbms:procedure(STRING data-source.name, STRING query)\nrdbms:procedure(STRING data-source.name, STRING query, STRING output.parameter)\nrdbms:procedure(STRING data-source.name, STRING query, STRING output.parameter, STRING|BOOL|INT|DOUBLE|FLOAT|LONG parameter,                       STRING|BOOL|INT|DOUBLE|FLOAT|LONG ...)\n")),(0,r.kt)("h3",{id:"procedure-examples"},"Procedure Examples"),(0,r.kt)("p",null,"In these examples, the values in the parentheses for ",(0,r.kt)("inlineCode",{parentName:"p"},"RETURNCON()")," are the input parameter and output parameter."),(0,r.kt)("p",null,"This example runs a stored procedure from the database called ",(0,r.kt)("inlineCode",{parentName:"p"},"RETURNCON()")," and returns the output ",(0,r.kt)("inlineCode",{parentName:"p"},"Name"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Age"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"Date_Time"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO tempStream1\nSELECT Name, Age, Date_Time\nFROM IntrimStream--#rdbms:procedure('ORACLE_DB', 'Name String, Age int,Date_Time String', 'begin RETURNCON(?,?); end;','cursor', NoOfYears);\n")),(0,r.kt)("p",null,"Make sure the stream is defined with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE STREAM IntrimStream (NoOfYears int, Name string, Age int, Date_Time string);\n")),(0,r.kt)("p",null,"The output parameter is ",(0,r.kt)("inlineCode",{parentName:"p"},"cursor")," and the input parameter is ",(0,r.kt)("inlineCode",{parentName:"p"},"NoOfYears"),"."),(0,r.kt)("p",null,"This example runs a stored procedure from the database called ",(0,r.kt)("inlineCode",{parentName:"p"},"RETURNCON()")," and returns the output ",(0,r.kt)("inlineCode",{parentName:"p"},"Name"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Age"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"Date_Time"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO tempStream1\nSELECT Name, Age, Date_Time\nFROM IntrimStream--#rdbms:procedure('ORACLE_DB', 'Name String, Age int,Date_Time String', 'begin RETURNCON(9,?); end;','cursor');\n")),(0,r.kt)("p",null,"Make sure the stream is defined with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE STREAM IntrimStream (NoOfYears int, Name string, Age int, Date_Time string);\n")),(0,r.kt)("p",null,"The output parameter is ",(0,r.kt)("inlineCode",{parentName:"p"},"cursor")," and the input parameter is ",(0,r.kt)("inlineCode",{parentName:"p"},"9")," as specified in the query."),(0,r.kt)("h2",{id:"query"},"Query"),(0,r.kt)("p",null,"You can use the Query function to perform SQL retrieval queries on a data source."),(0,r.kt)("h3",{id:"query-parameters"},"Query Parameters"),(0,r.kt)("p",null,"Insert the following parameters into the provided ",(0,r.kt)("a",{parentName:"p",href:"#template"},"template")," to create a Query function."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Data Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,r.kt)("th",{parentName:"tr",align:null},"Optional?"),(0,r.kt)("th",{parentName:"tr",align:null},"Dynamic?"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"data-source.name"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the data source on which to run the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"query"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"The INSERT, UPDATE, or DELETE query to be performed. Format according to the relevant database type.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"parameter"),(0,r.kt)("td",{parentName:"tr",align:null},"Any"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"If ",(0,r.kt)("inlineCode",{parentName:"td"},"query")," is a parameter used as a SQL query, you can use this field to pass CEP attributes to set parameter values.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"attribute.definition.list"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"A comma-separated list of attributes to return with the SQL query. Each item is processed in order. Supported data types are ",(0,r.kt)("inlineCode",{parentName:"td"},"STRING"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"INT"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"LONG"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"DOUBLE"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"FLOAT"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"BOOL"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ack.empty.result.set"),(0,r.kt)("td",{parentName:"tr",align:null},"BOOL"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"When set to ",(0,r.kt)("inlineCode",{parentName:"td"},"true"),", null values are returned if the result set is empty. When set to ",(0,r.kt)("inlineCode",{parentName:"td"},"false"),", nothing is returned if the result set is empty.")))),(0,r.kt)("p",null,"Additionally, ",(0,r.kt)("inlineCode",{parentName:"p"},"attributeName")," (any type) returns the attributes listed in the parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"attribute.definition.list"),"."),(0,r.kt)("h3",{id:"query-template"},"Query Template"),(0,r.kt)("p",null,"Use the following template to create a query function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"rdbms:query(STRING jdbc.url, STRING username, STRING password, STRING jdbc.driver.name, STRING attribute.definition.list, STRING query)\nrdbms:query(STRING jdbc.url, STRING username, STRING password, STRING jdbc.driver.name, STRING attribute.definition.list, STRING query, STRING|BOOL|INT|DOUBLE|FLOAT|LONG parameter, STRING|BOOL|INT|DOUBLE|FLOAT|LONG ...)\nrdbms:query(STRING data-source.name, STRING attribute.definition.list, STRING query, BOOL ack.empty.result.set)\nrdbms:query(STRING jdbc.url, STRING username, STRING password, STRING jdbc.driver.name, STRING attribute.definition.list, STRING query, STRING|BOOL|INT|DOUBLE|FLOAT|LONG parameter, STRING|BOOL|INT|DOUBLE|FLOAT|LONG ..., BOOL ack.empty.result.set)\n")),(0,r.kt)("h3",{id:"query-examples"},"Query Examples"),(0,r.kt)("p",null,"The following examples query ",(0,r.kt)("inlineCode",{parentName:"p"},"creditcardno"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"country"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"transaction"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"amount")," from a database called ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMPLE_DB"),", then generate an event for each record retrieval insert the events into the ",(0,r.kt)("inlineCode",{parentName:"p"},"recordStream")," output stream:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'INSERT INTO recordStream\nSELECT creditcardno, country, transaction, amount\nFROM TriggerStream#rdbms:query("jdbc:mysql://hostname:3306/MySQLDB?useSSL=false", "username", "password", "com.mysql.jdbc.Driver", \'creditcardno string, country string,transaction string, amount int\', \'select * from Transactions_Table\');   \n')),(0,r.kt)("p",null,"The event includes the attributes defined in the ",(0,r.kt)("inlineCode",{parentName:"p"},"attribute.definition.list")," as additional attributes (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"creditcardno string, country string, transaction string, amount int"),")."),(0,r.kt)("p",null,"Additionally, this example uses the ",(0,r.kt)("inlineCode",{parentName:"p"},"countrySearchWord")," parameter as a filter."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'INSERT INTO recordStream\nSELECT creditcardno, country, transaction, amount\nFROM TriggerStream#rdbms:query("jdbc:mysql://hostname:3306/MySQLDB?useSSL=false", "username", "password", "com.mysql.jdbc.Driver", \'creditcardno string, country string,transaction string, amount int\', \'select * from where country=?\', countrySearchWord);\n')),(0,r.kt)("p",null,"Make sure the stream is defined with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE STREAM TriggerStream (countrySearchWord string);\n")),(0,r.kt)("p",null,"This example returns null values if there are no events that satisfy the query:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'INSERT INTO recordStream \nSELECT creditcardno, country, transaction, amount\nFROM TriggerStream#rdbms:query("jdbc:mysql://hostname:3306/MySQLDB?useSSL=false", "username", "password", "com.mysql.jdbc.Driver", \n    \'creditcardno string, country string,transaction string, amount int\', \'select * from where country=?\', countrySearchWord, true);\n')),(0,r.kt)("p",null,"Make sure the stream is defined with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE STREAM TriggerStream (countrySearchWord string);\n")),(0,r.kt)("h2",{id:"store"},"Store"),(0,r.kt)("p",null,"The Store function can create and edit event tables, configure the table's data sources and connections, and insert, update, or delete data from the tables. It requires read-write permissions on connected data sources."),(0,r.kt)("h3",{id:"store-parameters"},"Store Parameters"),(0,r.kt)("p",null,"Insert the following parameters into the provided ",(0,r.kt)("a",{parentName:"p",href:"#template"},"template")," to create a Store function."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Data Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,r.kt)("th",{parentName:"tr",align:null},"Optional?"),(0,r.kt)("th",{parentName:"tr",align:null},"Dynamic?"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"jdbc.url"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"The JDBC URL used to access the RDBMS data store.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"username"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"The username used to access the RDBMS data store.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"password"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"The password used to access the RDBMS data store.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"jdbc.driver.name"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"The name of the JDBC SDK used to access the RDBMS data store.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"datasource"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"If you want to use a Carbon data source, specify the name of the data source on which to run the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"jndi.resource"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"null"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"If you want to use JNDI look-up, specify the name of the JNDI resource through which you want to attempt connection. If you use a data source, this is not used.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"pool.properties"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"null"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Use key-value pairs to specify any pool parameters for the database connection. If you use a datasource or jndi.resource, this is not used.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"table.name"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"Table name defined in CEP query."),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Specify the name to be used for the event table.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"field.length"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"Dependent on database type"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Use a comma-separated list of key-value pairs (",(0,r.kt)("inlineCode",{parentName:"td"},"field.name:"),") to specify the number of characters that fields in the table must contain.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"table.check.query"),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"tableCheckQuery")," value in RDBMS configuration."),(0,r.kt)("td",{parentName:"tr",align:null},"STRING"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"use.collation"),(0,r.kt)("td",{parentName:"tr",align:null},"BOOL"),(0,r.kt)("td",{parentName:"tr",align:null},"false"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Set to ",(0,r.kt)("inlineCode",{parentName:"td"},"true")," to enable collation for string attributes. We use ",(0,r.kt)("inlineCode",{parentName:"td"},"latin1_bin")," for MySQL and ",(0,r.kt)("inlineCode",{parentName:"td"},"SQL_Latin1_General_CP1_CS_AS")," for Microsoft SQL.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"allow.null.values"),(0,r.kt)("td",{parentName:"tr",align:null},"BOOL"),(0,r.kt)("td",{parentName:"tr",align:null},"false"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Set to ",(0,r.kt)("inlineCode",{parentName:"td"},"true")," to allow users to insert null values into numeric columns.")))),(0,r.kt)("h3",{id:"store-template"},"Store Template"),(0,r.kt)("p",null,"Use the following template to create a Store function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'@Store(type="rdbms", jdbc.url="STRING", username="STRING", password="STRING", jdbc.SDK.name="STRING", pool.properties="STRING", jndi.resource="STRING", datasource="STRING", table.name="STRING", field.length="STRING", table.check.query="STRING", use.collation="BOOL", allow.null.values="BOOL")\n@PrimaryKey("PRIMARY_KEY")\n@Index("INDEX")\n')),(0,r.kt)("h3",{id:"store-examples"},"Store Examples"),(0,r.kt)("p",null,"The following example creates an event table named ",(0,r.kt)("inlineCode",{parentName:"p"},"StockTable")," if one does not already exist in the database. The connection details are specified by the attributes under the ",(0,r.kt)("inlineCode",{parentName:"p"},"@Store")," annotation."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'CREATE STORE StockTable WITH (type="rdbms", jdbc.url="jdbc:mysql://localhost:3306/stocks", username="root", password="root", jdbc.driver.name="com.mysql.jdbc.Driver", field.length="symbol:100", PrimaryKey="id", PrimaryKey="symbol", Index="volume") (id string, symbol string, price float, volume long);\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"@PrimaryKey()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"@Index()")," annotations follow CEP query syntax to define the primary key and index for a table. Use commas to separate multiple attributes."),(0,r.kt)("p",null,"This example creates an event table named ",(0,r.kt)("inlineCode",{parentName:"p"},"StockTable"),", then adds a stream called ",(0,r.kt)("inlineCode",{parentName:"p"},"InputStream"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'CREATE STORE StockTable WITH (type="rdbms", jdbc.url="jdbc:mysql://localhost:3306/das", username="root", password="root" , jdbc.driver.name="org.h2.Driver", field.length="symbol:100", PrimaryKey="symbol", Index="symbol") (symbol string, price float, volume long);\nCREATE STREAM InputStream (symbol string, volume long);\n\nINSERT INTO FooStream\nSELECT a.symbol as symbol, b.volume as volume\nFROM InputStream as a join StockTable as b on str:contains(b.symbol, a.symbol);\n')),(0,r.kt)("p",null,"This example checks to see if a table named ",(0,r.kt)("inlineCode",{parentName:"p"},"StockTable")," exists in the database, and if not, creates an event table named ",(0,r.kt)("inlineCode",{parentName:"p"},"StockTable"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'CREATE STORE StockTable WITH (type="rdbms", jdbc.url="jdbc:mysql://localhost:3306/das", table.name="StockTable", username="root", password="root" , jdbc.driver.name=" com.mysql.jdbc.Driver ", field.length="symbol:100", table.check.query="SELECT 1 FROM StockTable LIMIT 1", PrimaryKey="symbol", Index="symbol") (symbol string, price float, volume long);\nCREATE STREAM InputStream (symbol string, volume long);\n\nINSERT INTO FooStream\nSELECT a.symbol as symbol, b.volume as volume\nFROM InputStream as a join StockTable as b on str:contains(b.symbol, a.symbol);\n')))}d.isMDXComponent=!0}}]);