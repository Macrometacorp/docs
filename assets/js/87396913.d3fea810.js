"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[67999],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>p});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=c(n),p=o,h=m["".concat(s,".").concat(p)]||m[p]||d[p]||i;return n?a.createElement(h,r(r({ref:t},u),{},{components:n})):a.createElement(h,r({ref:t},u))}));function p(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var c=2;c<i;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(67294),o=n(34334);const i="tabItem_Ymn6";function r(e){let{children:t,hidden:n,className:r}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(i,r),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(87462),o=n(67294),i=n(34334),r=n(72389),l=n(67392),s=n(7094),c=n(12466);const u="tabList__CuJ",d="tabItem_LNqP";function m(e){const{lazy:t,block:n,defaultValue:r,values:m,groupId:p,className:h}=e,f=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),v=m??f.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),y=(0,l.l)(v,((e,t)=>e.value===t.value));if(y.length>0)throw new Error(`Docusaurus error: Duplicate values "${y.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const b=null===r?r:r??f.find((e=>e.props.default))?.props.value??f[0].props.value;if(null!==b&&!v.some((e=>e.value===b)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${b}" but none of its children has the corresponding value. Available values are: ${v.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:k,setTabGroupChoices:g}=(0,s.U)(),[N,w]=(0,o.useState)(b),C=[],{blockElementScrollPositionUntilNextRender:D}=(0,c.o5)();if(null!=p){const e=k[p];null!=e&&e!==N&&v.some((t=>t.value===e))&&w(e)}const O=e=>{const t=e.currentTarget,n=C.indexOf(t),a=v[n].value;a!==N&&(D(t),w(a),null!=p&&g(p,String(a)))},T=e=>{let t=null;switch(e.key){case"ArrowRight":{const n=C.indexOf(e.currentTarget)+1;t=C[n]??C[0];break}case"ArrowLeft":{const n=C.indexOf(e.currentTarget)-1;t=C[n]??C[C.length-1];break}}t?.focus()};return o.createElement("div",{className:(0,i.Z)("tabs-container",u)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},h)},v.map((e=>{let{value:t,label:n,attributes:r}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,key:t,ref:e=>C.push(e),onKeyDown:T,onFocus:O,onClick:O},r,{className:(0,i.Z)("tabs__item",d,r?.className,{"tabs__item--active":N===t})}),n??t)}))),t?(0,o.cloneElement)(f.filter((e=>e.props.value===N))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},f.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==N})))))}function p(e){const t=(0,r.Z)();return o.createElement(m,(0,a.Z)({key:String(t)},e))}},62472:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));n(65488),n(85162);const i={sidebar_position:1,title:"Document Store"},r=void 0,l={unversionedId:"collections/documents/index",id:"collections/documents/index",title:"Document Store",description:"A document collection is a NoSQL database that stores data in JSON format (JavaScript Object Notation). Unlike traditional Relational Database Management Systems, document databases do not require a schema or a pre-defined structure with fixed tables and attributes. This is why they are also known as \u201cnon-relational\u201d databases.",source:"@site/docs/collections/documents/index.md",sourceDirName:"collections/documents",slug:"/collections/documents/",permalink:"/docs/collections/documents/",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/collections/documents/index.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Document Store"},sidebar:"defaultSidebar",previous:{title:"Retrieving Data",permalink:"/docs/collections/returning-collection-data"},next:{title:"Create a Document Store",permalink:"/docs/collections/documents/create-document-store"}},s={},c=[{value:"Document Attibutes",id:"document-attibutes",level:2},{value:"Document Handle",id:"document-handle",level:3},{value:"Document Key",id:"document-key",level:3},{value:"Document Revision",id:"document-revision",level:3},{value:"Multiple Documents in Single Call",id:"multiple-documents-in-single-call",level:2},{value:"Monetary Data",id:"monetary-data",level:2},{value:"Data Retrieval",id:"data-retrieval",level:2}],u={toc:c};function d(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"A document collection is a NoSQL database that stores data in JSON format (JavaScript Object Notation). Unlike traditional Relational Database Management Systems, document databases do not require a schema or a pre-defined structure with fixed tables and attributes. This is why they are also known as \u201cnon-relational\u201d databases."),(0,o.kt)("p",null,"A document is based on the concept of a \u201cKey-Value\u201d store. Every key has a corresponding value, different documents have unique keys which help with CRUD operations - Create, Read, Update, and Delete. No two documents can have common primary keys. Multiple documents gathered in one structure is known as a ",(0,o.kt)("em",{parentName:"p"},"document collection"),"."),(0,o.kt)("h2",{id:"document-attibutes"},"Document Attibutes"),(0,o.kt)("p",null,"A document can contain attributes that each store a value. A value can either be atomic (number, string, Boolean, or null), or compound (array or embedded document or object). Arrays and sub-objects can contain all of these types, so a single document can contain nested data structures."),(0,o.kt)("p",null,"Each document has two identifying attributes: The ",(0,o.kt)("inlineCode",{parentName:"p"},"_key")," identifies it within a single collection, and the ",(0,o.kt)("inlineCode",{parentName:"p"},"document handle")," identifies it across the entire GeoFabric. Additionally, the ",(0,o.kt)("inlineCode",{parentName:"p"},"document revision")," attribute distinguishes individual revisions of a document. Transaction only ever see a single document revision."),(0,o.kt)("p",null,"For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "_id" : "myusers/3456789",\n  "_key" : "3456789",\n  "_rev" : "14253647",\n  "firstName" : "John",\n  "lastName" : "Doe",\n  "address" : {\n    "street" : "Road To Nowhere 1",\n    "city" : "Gotham"\n  },\n  "hobbies" : [\n    {"name": "swimming", "howFavorite": 10},\n    {"name": "biking", "howFavorite": 6},\n    {"name": "programming", "howFavorite": 4}\n  ]\n}\n')),(0,o.kt)("p",null,"All documents contain special attributes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("a",{parentName:"li",href:"#document-handle"},"document handle")," (",(0,o.kt)("inlineCode",{parentName:"li"},"_id"),")."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("a",{parentName:"li",href:"#document-key"},"document's primary key")," (",(0,o.kt)("inlineCode",{parentName:"li"},"_key"),")."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("a",{parentName:"li",href:"#document-revision"},"document revision")," (",(0,o.kt)("inlineCode",{parentName:"li"},"_rev")," ).")),(0,o.kt)("p",null,"You can specify a ",(0,o.kt)("inlineCode",{parentName:"p"},"_key")," value when you create a document. ",(0,o.kt)("inlineCode",{parentName:"p"},"_id")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"_key")," values are unchangeable once the document has been created. The ",(0,o.kt)("inlineCode",{parentName:"p"},"_rev")," value is automatically updated."),(0,o.kt)("h3",{id:"document-handle"},"Document Handle"),(0,o.kt)("p",null,"A ",(0,o.kt)("em",{parentName:"p"},"document handle")," is a string (",(0,o.kt)("inlineCode",{parentName:"p"},"_id"),") that identifies a document in the GeoFabric database. The string value consists of the collection's name and the document's ",(0,o.kt)("inlineCode",{parentName:"p"},"_key")," separated by a slash ",(0,o.kt)("inlineCode",{parentName:"p"},"/"),"."),(0,o.kt)("h3",{id:"document-key"},"Document Key"),(0,o.kt)("p",null,"A ",(0,o.kt)("em",{parentName:"p"},"document key")," is an attribute (",(0,o.kt)("inlineCode",{parentName:"p"},"_key"),") that identifies a document in its collection and is primarily used for querying. Each document's ",(0,o.kt)("inlineCode",{parentName:"p"},"_key")," is unchangeable."),(0,o.kt)("p",null,"If you do not specify a key, one is automatically created. An automatic key is only unique within its collection or sharded collections in a cluster. Automatic keys might not be unique across different GeoFabrics. Each collection has a ",(0,o.kt)("inlineCode",{parentName:"p"},"keyOptions")," that can disallow user-specified keys completely or use a specific template for automatically creating keys."),(0,o.kt)("h3",{id:"document-revision"},"Document Revision"),(0,o.kt)("p",null,"A ",(0,o.kt)("em",{parentName:"p"},"document revision")," (",(0,o.kt)("inlineCode",{parentName:"p"},"_rev"),") is the MVCC (Multiple Version Concurrency Control) token that specifies a revision of a document. Revisions are read-only."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"_rev")," string is a timestamp that uses the local clock of the database. If different servers in a cluster have a time skew, the timestamps will not be comparable. The database automatically verifies that messages are consistently timestamped on both servers."),(0,o.kt)("p",null,"If there is causality between events on different servers, timestamps increase from cause to effect. The server might occasionally use a timestamp in the future to maintain consistency."),(0,o.kt)("p",null,"GDN uses 64-bit unsigned integer values to maintain document revisions internally. We do not document the exact format of the revision values. When returning document revisions to clients, we put them into a string to verify that the revision is not clipped by clients that do not support large integers."),(0,o.kt)("admonition",{title:"example",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"You can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"_rev")," attribute as a precondition for queries to avoid losing updates. If a client modifies a document locally without adjusting the revision value, then commits the changes ",(0,o.kt)("em",{parentName:"p"},"after")," another user modifies the same document, the first user's operation is cancelled by the server. Otherwise, the first user would inadvertently overwrite the second user's changes")),(0,o.kt)("h2",{id:"multiple-documents-in-single-call"},"Multiple Documents in Single Call"),(0,o.kt)("p",null,"GDN APIs can handle multiple documents in a single command, dramatically reducing the client and server overhead. You can do this by performing operations on JSON arrays of objects instead of a single document. As a consequence, document keys, handles and revisions for preconditions have to be supplied embedded in the individual documents given. Multiple document operations are restricted to a single document or edge collection."),(0,o.kt)("h2",{id:"monetary-data"},"Monetary Data"),(0,o.kt)("p",null,"GDN provides two ways to handle monetary data if you need to capture fractional units of currency and round decimals without precision loss."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Integer: You can use a general scale factor for digits up to 252 without precision loss. For example, if you set the scale factor to ",(0,o.kt)("inlineCode",{parentName:"p"},"100"),", GDN automatically converts 19.99 to 1999 before performing calculations and converting it back.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"String: You can use strings if you only want to store and retrieve monetary data. You cannot perform calculations on monetary data in strings."))),(0,o.kt)("h2",{id:"data-retrieval"},"Data Retrieval"),(0,o.kt)("p",null,"GDN provides the following methods of data retrieval:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'Queries filter documents based on specified criteria, compute new data, and update or delete existing documents. Queries can be as simple as a "query by example" or as complex as "joins" using many collections or traversing graph structures. GDN queries are written in the ',(0,o.kt)("a",{parentName:"li",href:"/docs/queryworkers/c8ql/"},"C8 Query Language (C8QL)"),"."),(0,o.kt)("li",{parentName:"ul"},"Cursors are used to iterate over the result of queries, so that you get easily processable batches instead of one big hunk."),(0,o.kt)("li",{parentName:"ul"},"Indexes can speed up your searches. Refer to the ",(0,o.kt)("a",{parentName:"li",href:"/docs/collections/indexing/"},"Indexing")," section for more information.")))}d.isMDXComponent=!0}}]);