"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[52381],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(67294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},u=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(t),m=l,b=d["".concat(s,".").concat(m)]||d[m]||p[m]||o;return t?a.createElement(b,r(r({ref:n},u),{},{components:t})):a.createElement(b,r({ref:n},u))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var o=t.length,r=new Array(o);r[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,r[1]=i;for(var c=2;c<o;c++)r[c]=t[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},85162:(e,n,t)=>{t.d(n,{Z:()=>r});var a=t(67294),l=t(34334);const o="tabItem_Ymn6";function r(e){let{children:n,hidden:t,className:r}=e;return a.createElement("div",{role:"tabpanel",className:(0,l.Z)(o,r),hidden:t},n)}},65488:(e,n,t)=>{t.d(n,{Z:()=>m});var a=t(87462),l=t(67294),o=t(34334),r=t(72389),i=t(67392),s=t(7094),c=t(12466);const u="tabList__CuJ",p="tabItem_LNqP";function d(e){const{lazy:n,block:t,defaultValue:r,values:d,groupId:m,className:b}=e,g=l.Children.map(e.children,(e=>{if((0,l.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),f=d??g.map((e=>{let{props:{value:n,label:t,attributes:a}}=e;return{value:n,label:t,attributes:a}})),y=(0,i.l)(f,((e,n)=>e.value===n.value));if(y.length>0)throw new Error(`Docusaurus error: Duplicate values "${y.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const h=null===r?r:r??g.find((e=>e.props.default))?.props.value??g[0].props.value;if(null!==h&&!f.some((e=>e.value===h)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${h}" but none of its children has the corresponding value. Available values are: ${f.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:k}=(0,s.U)(),[C,O]=(0,l.useState)(h),N=[],{blockElementScrollPositionUntilNextRender:E}=(0,c.o5)();if(null!=m){const e=v[m];null!=e&&e!==C&&f.some((n=>n.value===e))&&O(e)}const w=e=>{const n=e.currentTarget,t=N.indexOf(n),a=f[t].value;a!==C&&(E(n),O(a),null!=m&&k(m,String(a)))},L=e=>{let n=null;switch(e.key){case"ArrowRight":{const t=N.indexOf(e.currentTarget)+1;n=N[t]??N[0];break}case"ArrowLeft":{const t=N.indexOf(e.currentTarget)-1;n=N[t]??N[N.length-1];break}}n?.focus()};return l.createElement("div",{className:(0,o.Z)("tabs-container",u)},l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":t},b)},f.map((e=>{let{value:n,label:t,attributes:r}=e;return l.createElement("li",(0,a.Z)({role:"tab",tabIndex:C===n?0:-1,"aria-selected":C===n,key:n,ref:e=>N.push(e),onKeyDown:L,onFocus:w,onClick:w},r,{className:(0,o.Z)("tabs__item",p,r?.className,{"tabs__item--active":C===n})}),t??n)}))),n?(0,l.cloneElement)(g.filter((e=>e.props.value===C))[0],{className:"margin-top--md"}):l.createElement("div",{className:"margin-top--md"},g.map(((e,n)=>(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==C})))))}function m(e){const n=(0,r.Z)();return l.createElement(d,(0,a.Z)({key:String(n)},e))}},1972:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>s,default:()=>m,frontMatter:()=>i,metadata:()=>c,toc:()=>p});var a=t(87462),l=(t(67294),t(3905)),o=t(65488),r=t(85162);const i={sidebar_position:4,title:"Realtime Updates"},s=void 0,c={unversionedId:"collections/documents/tutorials/using-realtime-updates",id:"collections/documents/tutorials/using-realtime-updates",title:"Realtime Updates",description:"This tutorial is about using Macrometa GDN as a realtime database with local latencies across the globe.",source:"@site/docs/collections/documents/tutorials/using-realtime-updates.md",sourceDirName:"collections/documents/tutorials",slug:"/collections/documents/tutorials/using-realtime-updates",permalink:"/docs/collections/documents/tutorials/using-realtime-updates",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/main/docs/collections/documents/tutorials/using-realtime-updates.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"Realtime Updates"},sidebar:"defaultSidebar",previous:{title:"Bulk Update with RestQL",permalink:"/docs/collections/documents/tutorials/bulk-update-restql"},next:{title:"Maps, Sets, SortedSets",permalink:"/docs/collections/documents/tutorials/maps_sets_sortedsets"}},u={},p=[{value:"Pre-requisite",id:"pre-requisite",level:2},{value:"SDK download",id:"sdk-download",level:2},{value:"Code Sample",id:"code-sample",level:2}],d={toc:p};function m(e){let{components:n,...t}=e;return(0,l.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This tutorial is about using Macrometa GDN as a realtime database with local latencies across the globe."),(0,l.kt)("h2",{id:"pre-requisite"},"Pre-requisite"),(0,l.kt)("p",null,"Let's assume your"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Tenant name is ",(0,l.kt)("inlineCode",{parentName:"li"},"nemo@nautilus.com")," and"),(0,l.kt)("li",{parentName:"ul"},"User password is ",(0,l.kt)("inlineCode",{parentName:"li"},"xxxxxx"),".")),(0,l.kt)("h2",{id:"sdk-download"},"SDK download"),(0,l.kt)(o.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,l.kt)(r.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-py"},"  pyC8 requires Python 3.5+. Python 3.6 or higher is recommended\n\n  To install pyC8, simply run\n\n      $ pip3 install pyC8\n\n  or, if you prefer to use conda:\n\n      conda install -c conda-forge pyC8\n\n  or pipenv:\n\n      pipenv install --pre pyC8\n\n  Once the installation process is finished, you can begin developing applications in Python.\n"))),(0,l.kt)(r.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"  With Yarn or NPM\n\n      yarn add jsc8\n      (or)\n      npm install jsc8\n\n  If you want to use the SDK outside of the current directory, you can also install it globally using the `--global` flag:\n\n      npm install --global jsc8\n\n  From source,\n\n      git clone https://github.com/macrometacorp/jsc8.git\n      cd jsC8\n      npm install\n      npm run dist\n")))),(0,l.kt)("h2",{id:"code-sample"},"Code Sample"),(0,l.kt)(o.Z,{groupId:"operating-systems",mdxType:"Tabs"},(0,l.kt)(r.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-py"},'import time\nimport threading\nimport pprint\nfrom c8 import C8Client\n\n# Variables - URLs\nGLOBAL_URL = "play.paas.macrometa.io"\n\n# Variables - DB\nEMAIL = "nemo@nautilus.com"\nPASSWORD = "xxxxx"\nFABRIC = "_system"\nCOLLECTION_NAME = "ddos"\n\n# Variables - Data\ndata = [\n    {"ip": "10.1.1.1", "action": "block", "rule": "blacklistA"},\n    {"ip": "20.1.1.2", "action": "block", "rule": "blacklistA"},\n    {"ip": "30.1.1.3", "action": "block", "rule": "blacklistB"},\n    {"ip": "40.1.1.4", "action": "block", "rule": "blacklistA"},\n    {"ip": "50.1.1.5", "action": "block", "rule": "blacklistB"},\n]\n\npp = pprint.PrettyPrinter(indent=4)\n\nif __name__ == \'__main__\':\n\n    # Step1: Open connection to GDN. You will be routed to closest region.\n    print(f"\\n1. CONNECT: federation: {GLOBAL_URL},  user: {EMAIL}")\n    client = C8Client(protocol=\'https\', host=GLOBAL_URL, port=443,\n                      email=EMAIL, password=PASSWORD, geofabric=FABRIC)\n\n    # Step2: Create a collection if not exists\n    print(f"\\n2. CREATE_COLLECTION: region: {GLOBAL_URL},  collection: {COLLECTION_NAME}")\n    if client.has_collection(COLLECTION_NAME):\n        collection = client.collection(COLLECTION_NAME)\n    else:\n        collection = client.create_collection(COLLECTION_NAME, stream=True)\n\n\n    # Events are received by subscriber when changes are made to collection\n    def create_callback():\n        def callback_fn(event):\n            pp.pprint(event)\n\n        client.on_change(COLLECTION_NAME, callback=callback_fn, timeout=15)\n\n\n    # Step3: Subscribe to receive documents in realtime (PUSH model)\n    print(f"\\n3. SUBSCRIBE_COLLECTION: region: {GLOBAL_URL},  collection: {COLLECTION_NAME}")\n    rt_thread = threading.Thread(target=create_callback)\n    rt_thread.start()\n    time.sleep(2)\n    print(f"Callback registered for collection: {COLLECTION_NAME}")\n\n    # Step4: Subscribe to receive documents in realtime (PUSH model)\n    print(f"\\n4. INSERT_DOCUMENTS: region: {GLOBAL_URL},  collection: {COLLECTION_NAME}")\n    client.insert_document(COLLECTION_NAME, document=data)\n    \n    # Step5: Wait to close the callback.\n    print("\\n5. Waiting to close callback")\n    rt_thread.join(timeout=1)\n\n    print(f"\\n6. DELETE_DATA: region: {GLOBAL_URL}, collection: {COLLECTION_NAME}")\n    collection.truncate()\n    client.delete_collection(COLLECTION_NAME)\n'))),(0,l.kt)(r.Z,{value:"js",label:"Javascript",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const jsc8 = require("jsc8");\n\n// Constants - DB\nconst globalUrl = "https://play.paas.macrometa.io/";\nconst email = "nemo@nautilus.com";\nconst password = "XXXXXX";\nconst client = new jsc8(globalUrl);\n\n// Variables\nconst collectionName = "ddos";\nlet listener;\nconst data = [\n  { ip: "10.1.1.1", action: "block", rule: "blocklistA" },\n  { ip: "20.1.1.2", action: "block", rule: "blocklistA" },\n  { ip: "30.1.1.3", action: "block", rule: "blocklistB" },\n  { ip: "40.1.1.4", action: "block", rule: "blocklistA" },\n  { ip: "50.1.1.5", action: "block", rule: "blocklistB" }\n];\n\nconst sleep = (milliseconds) => {\n  return new Promise(resolve => setTimeout(resolve, milliseconds));\n};\n\n// Create an authenticated instance with token or API key\n\n// const client = new jsc8({url: globalUrl, token: "XXXX", fabricName: \'_system\'});\n// const client = new jsc8({url: globalUrl, apiKey: "XXXX", fabricName: \'_system\'});\n\n// Or use email and password to authenticate client instance\n\nasync function createCollection () {\n  console.log("\\n1. Log in.");\n  await client.login(email, password);\n  console.log("\\n2. Create collection.");\n  try {\n    console.log(`Creating the collection ${collectionName}...`);\n    const existsColl = await client.hasCollection(collectionName);\n    if (existsColl === false) {\n      await client.createCollection(collectionName, { stream: true });\n    }\n    // Adding an onChange listner for collection\n    listener = await client.onCollectionChange(collectionName);\n    // Decode the message printed here in readable format\n    listener.on("message", (msg) => {\n      const receivedMsg = msg && JSON.parse(msg);\n      console.log("message=>", Buffer.from(receivedMsg.payload, "base64").toString("ascii"))\n    });\n    listener.on("open", () => console.log("Connection open"));\n    listener.on("close", () => console.log("Connection closed"));\n  } catch (e) {\n    await console.log("Collection creation did not succeed due to " + e);\n  }\n}\nasync function insertData () {\n  console.log(`\\n3. Insert data in region ${globalUrl}`);\n  await client.insertDocumentMany(collectionName, data);\n}\nasync function deleteData () {\n  console.log("\\n4. Delete data");\n  await client.deleteCollection(collectionName);\n}\n(async function () {\n  await createCollection();\n  await sleep(2000);\n  await insertData();\n  await sleep(10000);\n  await listener.close();\n  await deleteData();\n})();\n')))))}m.isMDXComponent=!0}}]);