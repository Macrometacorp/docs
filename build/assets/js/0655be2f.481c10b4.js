"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4040],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),h=l(n),m=a,d=h["".concat(p,".").concat(m)]||h[m]||u[m]||o;return n?r.createElement(d,i(i({ref:t},c),{},{components:n})):r.createElement(d,i({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},60563:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return u}});var r=n(87462),a=n(63366),o=(n(67294),n(3905)),i=["components"],s={sidebar_position:8},p="Multiple Path Search",l={unversionedId:"c8ql/examples/multiple-path-search",id:"c8ql/examples/multiple-path-search",title:"Multiple Path Search",description:"The shortest path algorithm can only determine one shortest path.",source:"@site/docs/c8ql/examples/multiple-path-search.md",sourceDirName:"c8ql/examples",slug:"/c8ql/examples/multiple-path-search",permalink:"/docs/c8ql/examples/multiple-path-search",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Using Joins",permalink:"/docs/c8ql/examples/joins"},next:{title:"Projections and filters",permalink:"/docs/c8ql/examples/projections-and-filters"}},c={},u=[],h={toc:u};function m(e){var t=e.components,s=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},h,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"multiple-path-search"},"Multiple Path Search"),(0,o.kt)("p",null,"The shortest path algorithm can only determine one shortest path."),(0,o.kt)("p",null,"For example, if this is the full graph (based on the ",(0,o.kt)("a",{target:"_blank",href:n(23375).Z},"mps_graph"),"):"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Example Graph",src:n(52876).Z,width:"2080",height:"1460"})),(0,o.kt)("p",null,"then a shortest path query from ",(0,o.kt)("strong",{parentName:"p"},"A")," to ",(0,o.kt)("strong",{parentName:"p"},"C")," may return the path ",(0,o.kt)("inlineCode",{parentName:"p"},"A -> B -> C")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"A -> D -> C"),", but it's undefined which one (not taking edge weights into account here)."),(0,o.kt)("p",null,"You can use the efficient shortest path algorithm however, to determine the shortest path length:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'    RETURN LENGTH(\n      FOR v IN OUTBOUND\n        SHORTEST_PATH "mps_verts/A" TO "mps_verts/C" mps_edges\n          RETURN v\n    )   \n')),(0,o.kt)("p",null,"The result is 3 for the example graph (includes the start vertex). Now, subtract 1 to get the edge count / traversal depth. "),(0,o.kt)("p",null,"You can run a pattern matching traversal to find all paths with this length (or longer ones by increasing the min and max depth). Starting point is ",(0,o.kt)("strong",{parentName:"p"},"A")," again, and a filter on the document ID of v (or p.vertices","[-1]",") ensures that we only retrieve paths that end at point ",(0,o.kt)("strong",{parentName:"p"},"C"),"."),(0,o.kt)("p",null,"The following query returns all parts with length 2, start vertex ",(0,o.kt)("strong",{parentName:"p"},"A")," and target vertex ",(0,o.kt)("strong",{parentName:"p"},"C"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'    FOR v, e, p IN 2..2 OUTBOUND "mps_verts/A" mps_edges\n       FILTER v._id == "mps_verts/C"\n         RETURN CONCAT_SEPARATOR(" -> ", p.vertices[*]._key)\n')),(0,o.kt)("p",null,"A traversal depth of ",(0,o.kt)("inlineCode",{parentName:"p"},"3..3")," would return ",(0,o.kt)("inlineCode",{parentName:"p"},"A -> E -> F -> C")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"2..3")," all three paths."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Two separate queries are required to compute the shortest path length and to do the pattern matching based on the shortest path length (minus 1), because min and max depth can't be expressions (they have to be known in advance, so either be number literals or bind parameters."))))}m.isMDXComponent=!0},23375:function(e,t,n){t.Z=n.p+"assets/files/mps_graph-62c72b9517362812b0bc7d7ddadf82d1.png"},52876:function(e,t,n){t.Z=n.p+"assets/images/mps_graph-62c72b9517362812b0bc7d7ddadf82d1.png"}}]);