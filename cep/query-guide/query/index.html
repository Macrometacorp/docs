<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cep/query-guide/query">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Query | Macrometa</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://macrometa.com/docs/img/macrometa-preview-dark.png"><meta data-rh="true" name="twitter:image" content="https://macrometa.com/docs/img/macrometa-preview-dark.png"><meta data-rh="true" property="og:url" content="https://macrometa.com/docs/cep/query-guide/query"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:title" content="Macrometa Docs"><meta data-rh="true" name="og:description" content="Powering the next generation of apps and APIs. Store, process, and serve data within milliseconds of everyone on the planet."><meta data-rh="true" name="og:url" content="https://macrometa.com/docs/"><meta data-rh="true" name="og:image" content="https://macrometa.com/img/macrometa-preview-dark.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Query | Macrometa"><meta data-rh="true" name="description" content="Query defines the processing logic in Stream. It consumes events from one or more streams, named-windows, tables, and/or named-aggregations, process the events in a streaming manner, and generate output events into a stream, named-window, or table."><meta data-rh="true" property="og:description" content="Query defines the processing logic in Stream. It consumes events from one or more streams, named-windows, tables, and/or named-aggregations, process the events in a streaming manner, and generate output events into a stream, named-window, or table."><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://macrometa.com/docs/cep/query-guide/query"><link data-rh="true" rel="alternate" href="https://macrometa.com/docs/cep/query-guide/query" hreflang="en"><link data-rh="true" rel="alternate" href="https://macrometa.com/docs/cep/query-guide/query" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GHXKYI4VEC-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-T68NNDC"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-T68NNDC",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Macrometa" href="/docs/opensearch.xml">


<link rel="preconnect" href="https://posthog.prod.macrometa.io">
<script>!function(t,o){var e,p,n,i;o.__SV||(window.posthog=o,o._i=[],o.init=function(r,s,a){function c(t,o){var e=o.split(".");2==e.length&&(t=t[e[0]],o=e[1]),t[o]=function(){t.push([o].concat(Array.prototype.slice.call(arguments,0)))}}(n=t.createElement("script")).type="text/javascript",n.async=!0,n.src=s.api_host+"/static/array.js",(i=t.getElementsByTagName("script")[0]).parentNode.insertBefore(n,i);var g=o;for(void 0!==a?g=o[a]=[]:a="posthog",g.people=g.people||[],g.toString=function(t){var o="posthog";return"posthog"!==a&&(o+="."+a),t||(o+=" (stub)"),o},g.people.toString=function(){return g.toString(1)+".people (stub)"},e="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset".split(" "),p=0;p<e.length;p++)c(g,e[p]);o._i.push([r,s,a])},o.__SV=1)}(document,window.posthog||[]),posthog.init("phc_9S9df0RqQSuCLsW1CPln4f5XtZDUFwnp4abg1N2EHxb",{api_host:"https://posthog.prod.macrometa.io"})</script><link rel="stylesheet" href="/docs/assets/css/styles.95d0435b.css">
<link rel="preload" href="/docs/assets/js/runtime~main.ba2405bf.js" as="script">
<link rel="preload" href="/docs/assets/js/main.55f2bcd5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://macrometa.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs/img/macrometa-logo.svg" alt="Macrometa Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/macrometa-logo-dark.svg" alt="Macrometa Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/quickstart">Docs</a><a class="navbar__item navbar__link" href="/docs/api">API Reference</a><a href="https://support.macrometa.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--external">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://auth-play.macrometa.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--external">Log in<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/macrometacorp/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--external">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://join.slack.com/t/macrometa/shared_invite/zt-1j4f06xwm-5Y~yGQz8CVImOowdc80s1A" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--external">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://twitter.com/macrometa" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--external">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/release-notes/">Release Notes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Release Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/sdks/">SDKs</a><button aria-label="Toggle the collapsible sidebar category &#x27;SDKs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/api-docs/">APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/cli/">Command Line Interface</a><button aria-label="Toggle the collapsible sidebar category &#x27;Command Line Interface&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/account-management/">Account Management</a><button aria-label="Toggle the collapsible sidebar category &#x27;Account Management&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/geofabrics/">GeoFabrics</a><button aria-label="Toggle the collapsible sidebar category &#x27;GeoFabrics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/collections/">Collections</a><button aria-label="Toggle the collapsible sidebar category &#x27;Collections&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/search/search">Search</a><button aria-label="Toggle the collapsible sidebar category &#x27;Search&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/graphs/">Graphs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Graphs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/queryworkers/">Queries and Query Workers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Queries and Query Workers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/streams/">Streams</a><button aria-label="Toggle the collapsible sidebar category &#x27;Streams&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/cep/">Stream Workers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Stream Workers&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/cep/query-guide/">Query Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Query Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/cep/query-guide/functions/">Functions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/stream">Stream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cep/query-guide/query">Query</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/partition">Partition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/table-collection">Table (Collection)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/named-aggregation">Named Aggregation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/named-window">Named Window</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/trigger">Trigger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/script">Script Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/store">Store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/error-handling">Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/query-guide/adhoc">Ad Hoc Queries</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/cep/sink/">Sink</a><button aria-label="Toggle the collapsible sidebar category &#x27;Sink&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/cep/source/">Source</a><button aria-label="Toggle the collapsible sidebar category &#x27;Source&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/cep/tutorials/create-stream-app">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/cep/examples/">Examples</a><button aria-label="Toggle the collapsible sidebar category &#x27;Examples&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/cep/enrich-data/">Enrich Data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Enrich Data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/change-data-capture-plugin">Change Data Capture Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/store-rdbms-plugin">Store RDBMS Plugin</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/akamai/">Akamai Edge Workers - Preview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Akamai Edge Workers - Preview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/apps">Sample Apps</a><button aria-label="Toggle the collapsible sidebar category &#x27;Sample Apps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/references/glossary">References</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item hidden"><a class="menu__link" href="/docs/data">Global Data Mesh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item hidden"><a class="menu__link" href="/docs/development">Developer Tools</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Query</h1></header><p>Query defines the processing logic in Stream. It consumes events from one or more streams, <a href="/docs/cep/query-guide/named-window">named-windows</a>, <a href="/docs/cep/query-guide/table-collection">tables</a>, and/or <a href="/docs/cep/query-guide/named-aggregation">named-aggregations</a>, process the events in a streaming manner, and generate output events into a <a href="/docs/cep/query-guide/stream">stream</a>, <a href="/docs/cep/query-guide/named-window">named-window</a>, or <a href="/docs/cep/query-guide/table-collection">table</a>.</p><p><strong>Purpose</strong></p><p>A query provides a way to process the events in the order they arrive and produce output using both stateful and stateless complex event processing and stream processing operations.</p><p><strong>Syntax</strong></p><p>The high level query syntax for defining processing logics is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@name(&#x27;&lt;query name&gt;&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;output action&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;projection&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following parameters are used to configure a stream definition.</p><table><thead><tr><th>Parameter<!-- --> <!-- --> <!-- --> <!-- --> </th><th>Description</th></tr></thead><tbody><tr><td><code>query name</code></td><td>The name of the query. Since naming the query (i.e the <code>@name(&#x27;&lt;query name&gt;&#x27;)</code> annotation) is optional, when the name is not provided Stream assign a system generated name for the query.</td></tr><tr><td><code>input</code></td><td>Defines the means of event consumption via <a href="/docs/cep/query-guide/stream">streams</a>, <a href="/docs/cep/query-guide/named-window">named-windows</a>, <a href="/docs/cep/query-guide/table-collection">tables</a>, and/or <a href="/docs/cep/query-guide/named-aggregation">named-aggregations</a>, and defines the processing logic using <a href="#filter">filters</a>, <a href="#window">windows</a>, <a href="#stream-function">stream-functions</a>, <a href="#join">joins</a>, <a href="#pattern">patterns</a> and <a href="#sequence">sequences</a>.</td></tr><tr><td><code>projection</code></td><td>Generates output event attributes using <a href="#select">select</a>, <a href="#function">functions</a>, <a href="#aggregation-function">aggregation-functions</a>, and <a href="#group-by">group by</a> operations, and filters the generated the output using <a href="#having">having</a>, <a href="#limit-offset">limit &amp; offset</a>, <a href="#order-by">order by</a>, and <a href="#output-rate-limiting">output rate limiting</a> operations before sending them out. Here the projection is optional and when it is omitted all the input events will be sent to the output as it is.</td></tr><tr><td><code>output action</code></td><td>Defines output action (such as <code>insert into</code>, <code>update</code>, <code>delete</code>, etc) that needs to be performed by the generated events on a <a href="/docs/cep/query-guide/stream">stream</a>, <a href="/docs/cep/query-guide/named-window">named-window</a>, or <a href="/docs/cep/query-guide/table-collection">table</a></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h3><p>A query consumes events from the <code>TempStream</code> stream and output only the <code>roomNo</code> and <code>temp</code> attributes to the <code>RoomTempStream</code> stream, from which another query consumes the events and sends all its attributes to <code>AnotherRoomTempStream</code> stream.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into RoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, temp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AnotherRoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from RoomTempStream;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>&quot;Inferred Stream&quot;</div><div class="admonitionContent_S0QG"><p>Here, the <code>RoomTempStream</code> and <code>AnotherRoomTempStream</code> streams are an inferred streams, which means their stream definitions are inferred from the queries and they can be used same as any other defined stream without any restrictions.  </p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="value">Value<a class="hash-link" href="#value" title="Direct link to heading">​</a></h3><p>Values are typed data, that can be manipulated, transferred and stored. Values can be referred by the attributes defined in definitions such as streams, and tables.</p><p>Stream supports values of type <code>STRING</code>, <code>INT</code> (Integer), <code>LONG</code>, <code>DOUBLE</code>, <code>FLOAT</code>, <code>BOOL</code> (Boolean) and <code>OBJECT</code>.</p><p>The syntax of each type and their example use as a constant value is as follows,</p><table style="width:100%"><tr><th style="width:10%">Attribute Type</th><th style="width:50%">Format</th><th style="width:40%">Example</th></tr><tr><td>int</td><td>`&amp;ltdigit&amp;gt+`</td><td>`123`, `-75`, `+95`</td></tr><tr><td>long</td><td>`&amp;ltdigit&amp;gt+L`</td><td>`123000L`, `-750l`, `+154L`</td></tr><tr><td>float</td><td>`(&amp;ltdigit&amp;gt+)?(&#x27;.&#x27;&amp;ltdigit&amp;gt*)?(E(-|+)?&amp;ltdigit&amp;gt+)?F`</td><td>`123.0f`, `-75.0e-10F`,`+95.789f`</td></tr><tr><td>double</td><td>`(&amp;ltdigit&amp;gt+)?(&#x27;.&#x27;&amp;ltdigit&amp;gt*)?(E(-|+)?&amp;ltdigit&amp;gt+)?D?`</td><td>`123.0`,`123.0D`,`-75.0e-10D`,`+95.789d`</td></tr><tr><td>bool</td><td>`(true|false)`</td><td>`true`, `false`, `TRUE`, `FALSE`</td></tr><tr><td>string</td><td>`&#x27;(&lt;char&gt;*!(&#x27;|&quot;|&quot;&quot;&quot;|&amp;ltnew line&amp;gt))&#x27;` or  `&quot;(&lt;char&gt;* !(&quot;|&quot;&quot;&quot;|&amp;ltnew line&amp;gt))&quot;` or `&quot;&quot;&quot;(&lt;char&gt;* !(&quot;&quot;&quot;))&quot;&quot;&quot;` </td><td>`&#x27;Any text.&#x27;`, `&quot;Text with &#x27;single&#x27; quotes.&quot;`, <div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;&quot;&quot; Text with &#x27;single&#x27; quotes, &quot;double&quot; quotes, and new lines. &quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></td></tr></table><p><strong><em>Time</em></strong></p><p>Time is a special type of <code>LONG</code> value that denotes time using digits and their unit in the format <code>(&lt;digit&gt;+ &lt;unit&gt;)+</code>. At execution, the <code>time</code> gets converted into <strong>milliseconds</strong> and returns a <code>LONG</code> value.</p><table style="width:100%"><tr><th>Unit</th><th>Syntax</th></tr><tr><td>Year</td><td>`year` | `years`</td></tr><tr><td>Month</td><td>`month` | `months`</td></tr><tr><td>Week</td><td>`week` | `weeks`</td></tr><tr><td>Day</td><td>`day` | `days`</td></tr><tr><td>Hour</td><td>`hour` | `hours`</td></tr><tr><td>Minutes</td><td>`minute` | `minutes` | `min`</td></tr><tr><td>Seconds</td><td>`second` | `seconds` | `sec`</td></tr><tr><td>Milliseconds</td><td>`millisecond` | `milliseconds`</td></tr></table><p><strong>Example</strong></p><p>1 hour and 25 minutes can by written as <code>1 hour and 25 minutes</code> which is equal to the <code>LONG</code> value <code>5100000</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="select">Select<a class="hash-link" href="#select" title="Direct link to heading">​</a></h3><p>The select clause in stream query defines the output event attributes of the query. Following are some basic query projection operations supported by select.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="function">Function<a class="hash-link" href="#function" title="Direct link to heading">​</a></h3><p>Functions are pre-configured operations that can consumes zero, or more parameters and always produce a single value as result. It can be used anywhere an attribute can be used.</p><p><strong>Purpose</strong></p><p>Functions encapsulate pre-configured reusable execution logic allowing users to execute the logic anywhere just by calling the function. This also make writing StreamApps simple and easy to understand.</p><p><strong>Syntax</strong></p><p>The syntax of function is as follows,</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">parameter</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here <code>&lt;function name&gt;</code> uniquely identifies the function. The <code>&lt;parameter&gt;</code> defined input parameters the function can accept. The input parameters can be attributes, constant values, results of other functions, results of mathematical or logical expressions, or time values. The number and type of parameters a function accepts depend on the function itself.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Functions, mathematical expressions, and logical expressions can be used in a nested manner.</p></div></div><p><strong>Example 1</strong></p><p>Function name <code>add</code> accepting two input parameters, is called with an attribute named <code>input</code> and a constant value <code>75</code>.  </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">add(input, 75)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 2</strong></p><p>Function name <code>alertAfter</code> accepting two input parameters, is called with a time value of <code>1 hour and 25 minutes</code> and a mathematical addition operation of <code>startTime</code> + <code>56</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">add(1 hour and 25 minutes, startTime + 56)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Inbuilt functions</strong></p><p>Following are some inbuilt Stream functions, for more functions refer <a href="#function">Functions</a>.</p><table><thead><tr><th>Inbuilt function</th><th>Description</th></tr></thead><tbody><tr><td><a href="/docs/cep/query-guide/functions#eventtimestamp-function">eventTimestamp</a></td><td>Returns event&#x27;s timestamp.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#currenttimemillis-function">currentTimeMillis</a></td><td>Returns current time of StreamApp runtime.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#default-function">default</a></td><td>Returns a default value if the parameter is null.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#ifthenelse-function">ifThenElse</a></td><td>Returns parameters based on a conditional parameter.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#uuid-function">UUID</a></td><td>Generates a UUID.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#cast-function">cast</a></td><td>Casts parameter type.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#convert-function">convert</a></td><td>Converts parameter type.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#coalesce-function">coalesce</a></td><td>Returns first not null input parameter.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#maximum-function">maximum</a></td><td>Returns the maximum value of all parameters.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#minimum-function">minimum</a></td><td>Returns the minimum value of all parameters.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#instanceofboolean-function">instanceOfBoolean</a></td><td>Checks if the parameter is an instance of Boolean.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#instanceofdouble-function">instanceOfDouble</a></td><td>Checks if the parameter is an instance of Double.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#instanceoffloat-function">instanceOfFloat</a></td><td>Checks if the parameter is an instance of Float.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#instanceofinteger-function">instanceOfInteger</a></td><td>Checks if the parameter is an instance of Integer.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#instanceoflong-function">instanceOfLong</a></td><td>Checks if the parameter is an instance of Long.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#instanceOfString-function">instanceOfString</a></td><td>Checks if the parameter is an instance of String.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#createset-function">createSet</a></td><td>Creates  HashSet with given input parameters.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#sizeofset-function">sizeOfSet</a></td><td>Returns number of items in the HashSet, that&#x27;s passed as a parameter.</td></tr></tbody></table><p><strong>Example</strong></p><p>Query that converts the <code>roomNo</code> to <code>string</code> using <code>convert</code> function, finds the maximum temperature reading with <code>maximum</code> function, and adds a unique <code>messageID</code> using the <code>UUID</code> function.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into RoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select convert(roomNo, &#x27;string&#x27;) as roomNo,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       maximum(tempReading1, tempReading2) as temp,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       UUID() as messageID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="filter">Filter<a class="hash-link" href="#filter" title="Direct link to heading">​</a></h3><p>Filters provide a way of filtering input stream events based on a specified condition. It accepts any type of condition including a combination of functions and/or attributes  that produces a Boolean result. Filters allow events to passthrough if the condition results in <code>true</code>, and drops if it results in a <code>false</code>.  </p><p><strong>Purpose</strong></p><p>Filter helps to select the events that are relevant for the processing and omit the ones that are not.</p><p><strong>Syntax</strong></p><p>Filter conditions should be defined in square brackets (<code>[]</code>) next to the input stream as shown below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;[&lt;filter condition&gt;] ;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>Query to filter <code>TempStream</code> stream events, having <code>roomNo</code> within the range of 100-210 and temperature greater than 40 degrees,
and insert them into <code>HighTempStream</code> stream.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into HighTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, temp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream[(roomNo &gt;= 100 and roomNo &lt; 210) and temp &gt; 40];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="window">Window<a class="hash-link" href="#window" title="Direct link to heading">​</a></h3><p>Window provides a way to capture a subset of events from an input stream and retain them for a period of time based on a specified criterion. The criterion defines when and how the events should be evicted from the windows. Such as events getting evicted from the window based on the time duration, or number of events and they events are evicted in a sliding (one by one) or tumbling (batch) manner.</p><p>Within a query, each input stream can at most have only one window associated with it.</p><p><strong>Purpose</strong></p><p>Windows help to retain events based on a criterion, such that the values of those events can be aggregated, or checked if an event of interest is within the window or not.</p><p><strong>Syntax</strong></p><p>Define the window by using the <code>window &lt;window-name&gt;</code> next to the input stream as shown below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert &lt;output event type&gt;? into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... );</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Filter conditions can be applied both before and/or after the window.</p></div></div><p><strong>Core windows</strong></p><p>Following are some core Stream windows, for more windows refer <a href="/docs/cep/query-guide/functions/unique">here</a>.</p><table><thead><tr><th>Core window function</th><th>Description</th></tr></thead><tbody><tr><td><a href="/docs/cep/query-guide/functions/core/time">time</a></td><td>Retains events based on time in a sliding manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/timeBatch">timeBatch</a></td><td>Retains events based on time in a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/length">length</a></td><td>Retains events based on number of events in a sliding manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/lengthBatch">lengthBatch</a></td><td>Retains events based on number of events in a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/timeLength">timeLength</a></td><td>Retains events based on time and number of events in a sliding manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/session">session</a></td><td>Retains events for each session based on session key.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/batch">batch</a></td><td>Retains events of last arrived event chunk.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/sort">sort</a></td><td>Retains top-k or bottom-k events based on a parameter value.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/cron">cron</a></td><td>Retains events based on cron time in a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/externalTime">externalTime</a></td><td>Retains events based on event time value passed as a parameter in a sliding manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/externalTimeBatch">externalTimeBatch</a></td><td>Retains events based on event time value passed as a parameter in a a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/query-guide/functions/core/delay">delay</a></td><td>Retains events and delays the output by the given time period in a sliding manner.</td></tr></tbody></table><p><strong>Example 1</strong></p><p>Query to find out the maximum temperature out of the <strong>last 10 events</strong>, using the window of <code>length</code> 10 and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window sliding_length(10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the <code>length</code> window operates in a sliding manner where the following 3 event subsets are calculated and outputted when a list of 12 events are received in sequential order.</p><table><thead><tr><th>Subset</th><th>Event Range</th></tr></thead><tbody><tr><td>1</td><td>1 - 10</td></tr><tr><td>2</td><td>2 - 11</td></tr><tr><td>3</td><td>3 - 12</td></tr></tbody></table><p><strong>Example 2</strong></p><p>Query to find out the maximum temperature out of the <strong>every 10 events</strong>, using the window of <code>lengthBatch</code> 10 and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window tumbling_length(10);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the window operates in a batch/tumbling manner where the following three event subsets are calculated and outputted when a list of 30 events are received in a sequential order.</p><table><thead><tr><th>Subset</th><th>Event Range</th></tr></thead><tbody><tr><td>1</td><td>1 - 10</td></tr><tr><td>2</td><td>11 - 20</td></tr><tr><td>3</td><td>21 - 30</td></tr></tbody></table><p><strong>Example 3</strong></p><p>Query to find out the maximum temperature out of the events arrived <strong>during last 10 minutes</strong>, using the window of <code>time</code> 10 minutes and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window sliding_time(10 min);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the <code>time</code> window operates in a sliding manner with millisecond accuracy, where it will process events in the following three time durations and output aggregated events when a list of events are received in a sequential order.</p><table><thead><tr><th>Subset</th><th>Time Range (in ms)</th></tr></thead><tbody><tr><td>1</td><td>1:00:00.001 - 1:10:00.000</td></tr><tr><td>2</td><td>1:00:01.001 - 1:10:01.000</td></tr><tr><td>3</td><td>1:00:01.033 - 1:10:01.034</td></tr></tbody></table><p><strong>Example 4</strong></p><p>Query to find out the maximum temperature out of the events arriving <strong>every 10 minutes</strong>, using the window of <code>timeBatch</code> 10 and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window tumbling_time(10 min);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the window operates in a batch/tumbling manner where the window will process events in the following three time durations and output aggregated events when a list of events are received in a sequential order.</p><table><thead><tr><th>Subset</th><th>Time Range (in ms)</th></tr></thead><tbody><tr><td>1</td><td>1:00:00.001 - 1:10:00.000</td></tr><tr><td>2</td><td>1:10:00.001 - 1:20:00.000</td></tr><tr><td>3</td><td>1:20:00.001 - 1:30:00.000</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-type">Event Type<a class="hash-link" href="#event-type" title="Direct link to heading">​</a></h3><p>Query output depends on the <code>current</code> and <code>expired</code> event types it produces based on its internal processing state. By default all queries produce <code>current</code> events upon event arrival to the query. The queries containing windows additionally produce <code>expired</code> events when events expire from the windows.</p><p><strong>Purpose</strong></p><p>Event type helps to specify when a query should output events to the stream, such as output upon current events, expired events or upon both current and expired events.</p><p><strong>Syntax</strong></p><p>Event type should be defined in between <code>insert</code> and <code>into</code> keywords for insert queries as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert &lt;event type&gt; into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event type should be defined next to the <code>for</code> keyword for delete queries as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event type should be defined next to the <code>for</code> keyword for update queries as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event type should be defined next to the <code>for</code> keyword for update or insert queries as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update or insert into &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Controlling query output based on the event types neither alters query execution nor its accuracy.  </p></div></div><p>The event types can be defined using the following keywords to manipulate query output.</p><table><thead><tr><th>Event types</th><th>Description</th></tr></thead><tbody><tr><td><code>current events</code></td><td>Outputs events only when incoming events arrive to be processed by the query.  This is default behavior when no specific event type is specified.</td></tr><tr><td><code>expired events</code></td><td>Outputs events only when events expires from the window.</td></tr><tr><td><code>all events</code></td><td>Outputs events when incoming events arrive to be processed by the query as well as  when events expire from the window.</td></tr></tbody></table><p><strong>Example</strong></p><p>Query to output only the expired events from a 1 minute time window to the <code>DelayedTempStream</code> stream. This can be used for delaying the events by a minute.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert expired events into DelayedTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window sliding_time(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>This is just to illustrate how expired events work. Use the <a href="/docs/cep/query-guide/functions/core/delay">delay</a> window for use cases where we need to delay events by a given time period.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aggregate-function">Aggregate Function<a class="hash-link" href="#aggregate-function" title="Direct link to heading">​</a></h3><p>Aggregate functions are pre-configured aggregation operations that can consumes zero, or more parameters from multiple events and always produce a single value as result. They can be only used in the query projection (as part of the <code>select</code> clause). When a query comprises a window, the aggregation will be contained to the events in the window, and when it does not have a window, the aggregation is performed from the first event the query has received.</p><p><strong>Purpose</strong></p><p>Aggregate functions encapsulate pre-configured reusable aggregate logic allowing users to aggregate values of multiple events together. When used with batch/tumbling windows this can also help to reduce the number of output events produced.  </p><p><strong>Syntax</strong></p><p>Aggregate function can be used in query projection (as part of the <code>select</code> clause) alone or as a part of another expression. In all cases, the output produced by the query should be properly mapped to the output stream attribute using the <code>as</code> keyword.</p><p>The syntax of aggregate function is as follows,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... ) as &lt;attribute name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... );</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here <code>&lt;aggregate function&gt;</code> uniquely identifies the aggregate function. The <code>&lt;parameter&gt;</code> defines input parameters the aggregate function can accept. The input parameters can be attributes, constant values, results of other functions or aggregate functions, results of mathematical or logical expressions, or time values. The number and type of parameters an aggregate function accepts depend on the function itself.</p><p><strong>Inbuilt aggregate functions</strong></p><p>Following are some inbuilt aggregation functions.</p><table><thead><tr><th>Inbuilt aggregate function</th><th>Description</th></tr></thead><tbody><tr><td><a href="/docs/cep/query-guide/functions#sum-aggregate-function">sum</a></td><td>Calculates the sum from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#count-aggregate-function">count</a></td><td>Calculates the count from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#distinctcount-aggregate-function">distinctcount</a></td><td>Calculates the distinct count based on a parameter from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#avg-aggregate-function">avg</a></td><td>Calculates the average from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#max-aggregate-function">max</a></td><td>Finds the maximum value from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#min-aggregate-function">min</a></td><td>Finds the minimum value from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#maxForever-aggregate-function">maxForever</a></td><td>Finds the maximum value from all events throughout its lifetime irrespective of the windows.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#minForever-aggregate-function">minForever</a></td><td>Finds the minimum value from all events throughout its lifetime irrespective of the windows.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#stdDev-aggregate-function">stddev</a></td><td>Calculates the standard deviation from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#and-aggregate-function">and</a></td><td>Calculates boolean and from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#or-aggregate-function">or</a></td><td>Calculates boolean or from a set of values.</td></tr><tr><td><a href="/docs/cep/query-guide/functions#unionSet-aggregate-function">unionSet</a></td><td>Calculates union as a Set from a set of values.</td></tr></tbody></table><p><strong>Example</strong></p><p>Query to calculate average, maximum, and minimum values on <code>temp</code> attribute of the <code>TempStream</code> stream in a sliding manner, from the events arrived over the last 10 minutes and to produce outputs <code>avgTemp</code>, <code>maxTemp</code> and <code>minTemp</code> respectively to the <code>AvgTempStream</code> output stream.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select avg(temp) as avgTemp, max(temp) as maxTemp, min(temp) as minTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window sliding_time(10 min);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="group-by">Group By<a class="hash-link" href="#group-by" title="Direct link to heading">​</a></h3><p>Group By provides a way of grouping events based on one or more specified attributes to perform aggregate operations.</p><p><strong>Purpose</strong></p><p>Group By allows users to aggregate values of multiple events based on the given group-by fields.</p><p><strong>Syntax</strong></p><p>The syntax for the Group By with aggregate function is as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;(...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here the group by attributes should be defined next to the <code>group by</code> keyword separating each attribute by a comma.</p><p><strong>Example</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination, from the events arrived from <code>TempStream</code> stream, during the last 10 minutes time-window in a sliding manner.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window sliding_time(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="having">Having<a class="hash-link" href="#having" title="Direct link to heading">​</a></h3><p>Having provide a way of filtering events based on a specified condition of the query output stream attributes. It accepts any type of condition including a combination of functions and/or attributes that produces a Boolean result. Having, allow events to passthrough if the condition results in <code>true</code>, and drops if it results in a <code>false</code>.  </p><p><strong>Purpose</strong></p><p>Having helps to select the events that are relevant for the output based on the attributes those are produced by the <code>select</code> clause and omit the ones that are not.</p><p><strong>Syntax</strong></p><p>The syntax for the Having clause is as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;( ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having &lt;condition&gt;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here the having <code>&lt;condition&gt;</code> should be defined next to the <code>having</code> keyword and having can be used with or without <code>group by</code> clause.</p><p><strong>Example</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> for the last 10 minutes, and alerts if the <code>avgTemp</code> exceeds 30 degrees.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window sliding_time(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having avgTemp &gt; 30;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="order-by">Order By<a class="hash-link" href="#order-by" title="Direct link to heading">​</a></h3><p>Order By, orders the query results in ascending and or descending order based on one or more specified attributes. When an attribute is used for order by, by default Stream orders the events in ascending order of that attribute&#x27;s value, and by adding <code>desc</code> keyword, the events can be ordered in descending order. When more than one attribute is defined the attributes defined towards the left will have more precedence in ordering than the ones defined in right.  </p><p><strong>Purpose</strong></p><p>Order By helps to sort the events in the outputs chunks produced by the query. Order By will be more helpful for batch windows, and queries where they output many of event together then for sliding window use cases where the output will be one or few events at a time.</p><p><strong>Syntax</strong></p><p>The syntax for the Order By clause is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;( ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having &lt;condition&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by &lt;attribute1 name&gt; (asc|desc)?, &lt;attribute2 name&gt; (asc|desc)?, ...;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here the order by attributes should be defined next to the <code>order by</code> keyword separating each by a comma, and optionally specifying the event ordering using <code>asc</code> (default) or <code>desc</code> keywords.</p><p><strong>Example</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination on every 10 minutes batches, and order the generated output events in ascending order by <code>avgTemp</code> and then by descending order of <code>roomNo</code> (if the more than one event have the same <code>avgTemp</code> value).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window tumbling_time(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by avgTemp, roomNo desc;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="limit--offset">Limit &amp; Offset<a class="hash-link" href="#limit--offset" title="Direct link to heading">​</a></h3><p>These provide a way to select the number of events (via limit) from the desired index (by specifying an offset) from the output event chunks produced by the query.</p><p><strong>Purpose</strong></p><p>Limit &amp; Offset helps to output only the selected set of events from large event batches. This will be more useful with <code>Order By</code> clause where one can order the output for topK, bottomK, or even to paginate through the dataset by obtaining a set of events from the middle.</p><p><strong>Syntax</strong></p><p>The syntax for the Limit &amp; Offset clauses is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; window &lt;window name&gt;( ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having &lt;condition&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by &lt;attribute1 name&gt; (asc | desc)?, &lt;attribute2 name&gt; (&lt;ascend/descend&gt;)?, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit &lt;positive integer&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">offset &lt;positive integer&gt;?;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here both <code>limit</code> and <code>offset</code> are optional, when <code>limit</code> is omitted the query will output all the events, and when <code>offset</code> is omitted <code>0</code> is taken as the default offset value.</p><p><strong>Example 1</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination for every 10 minutes batches, from the events arriving at the <code>TempStream</code> stream, and emit only two events having the highest <code>avgTemp</code> value.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into HighestAvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window timeBatch(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by avgTemp desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit 2;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 2</strong>
Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination for every 10 minutes batches, for events that arriving at the <code>TempStream</code> stream, and emits only the third, forth and fifth events when sorted in descending order based on their <code>avgTemp</code> value.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into HighestAvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream window timeBatch(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by avgTemp desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">offset 2;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="join-stream">Join (Stream)<a class="hash-link" href="#join-stream" title="Direct link to heading">​</a></h3><p>Joins allow you to get a combined result from two streams in real-time based on a specified condition.</p><p><strong>Purpose</strong></p><p>Streams are stateless. Therefore, in order to join two streams, they need to be connected to a window so that there is a pool of events that can be used for joining. Joins also accept conditions to join the appropriate events from each stream.</p><p>During the joining process each incoming event of each stream is matched against all the events in the other
stream&#x27;s window based on the given condition, and the output events are generated for all the matching event pairs.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Join can also be performed with <a href="#join-table">stored data</a>, <a href="#join-aggregation">aggregation</a> or externally <a href="#join-window">named windows</a>.</p></div></div><p><strong>Syntax</strong></p><p>The syntax for a join is as follows:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">output stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> WINDOW </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">window </span><span class="token keyword" style="color:#00009f">type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">parameter</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {unidirectional} {</span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">reference</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token keyword" style="color:#00009f">JOIN</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> WINDOW </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">window </span><span class="token keyword" style="color:#00009f">type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">parameter</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {unidirectional} {</span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">reference</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> condition</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the <code>&lt;join condition&gt;</code> allows you to match the attributes from both the streams.</p><p><strong>Unidirectional join operation</strong></p><p>By default, events arriving at either stream can trigger the joining process. However, if you want to control the
join execution, you can add the <code>unidirectional</code> keyword next to a stream in the join definition as depicted in the
syntax in order to enable that stream to trigger the join operation. Here, events arriving at other stream only update the
window of that stream, and this stream does not trigger the join operation.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The <code>unidirectional</code> keyword cannot be applied to both the input streams because the default behaviour already allows both streams to trigger the join operation.</p></div></div><p><strong>Example</strong></p><p>Assuming that the temperature of regulators are updated every minute.
Following is a stream worker that controls the temperature regulators if they are not already <code>on</code> for all the rooms with a room temperature greater than 30 degrees.  </p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">@App</span><span class="token plain">:name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;tempRegulator&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@App</span><span class="token plain">:qlVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">1. Payload to send to TempStream: {&quot;deviceID&quot;:12,&quot;roomNo&quot;: 1,&quot;temp&quot;: 34}</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="display:inline-block;color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">2. Payload to send to RegulatorStream: {&quot;deviceID&quot;:12,&quot;roomNo&quot;: 1,&quot;isOn&quot;: false}</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="display:inline-block;color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">3. Result in RegulatorActionStream :{&quot;roomNo&quot;:1,&quot;action&quot;:&quot;start&quot;,&quot;deviceID&quot;:12}</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="display:inline-block;color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">This stream worker joins TempStream and RegulatorStream and if the temperature ingested in TempStream is greater than 30.0 and if the isOn property is equal to false in Regulator stream, produces this output in RegulatorActionStream {&quot;roomNo&quot;:1,&quot;action&quot;:&quot;start&quot;,&quot;deviceID&quot;:12}</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="display:inline-block;color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">Streams are stateless. Therefore, in order to join two streams, they need to be connected to a window so that there is a </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">pool of events that can be used for joining. </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="display:inline-block;color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">A sliding time window that, at a given time holds the last window length events that arrived during last window time period, </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">and gets updated for every event arrival and expiration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="display:inline-block;color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> STREAM TempStream </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deviceID long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomNo </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">double</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> STREAM RegulatorStream </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deviceID long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomNo </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isOn </span><span class="token keyword" style="color:#00009f">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> SINK RegulatorActionStream </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;stream&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stream</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;RegulatorActionStream&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;json&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">OnError</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">action</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;log&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">roomNo </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> deviceID long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">action</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> RegulatorActionStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">roomNo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> R</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deviceID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;start&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">action</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> TempStream</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> WINDOW SLIDING_LENGTH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">JOIN</span><span class="token plain"> RegulatorStream</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">isOn </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> WINDOW SLIDING_LENGTH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> R</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">roomNo </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> R</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">roomNo</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Supported join types</strong></p><p>Following are the supported operations of a join clause.</p><ul><li><p><strong>Inner join (join)</strong></p><p>  This is the default behaviour of a join operation. <code>join</code> is used as the keyword to join both the streams. The output is generated only if there is a matching event in both the streams.</p></li><li><p><strong>Left outer join</strong></p><p>  The <code>left outer join</code> operation allows you to join two streams to be merged based on a condition. <code>left outer join</code> is used as the keyword to join both the streams.</p><p>  Here, it returns all the events of left stream even if there are no matching events in the right stream by
having null values for the attributes of the right stream.</p><p>   <strong>Example</strong></p><p>  The following query generates output events for all events from the <code>StockStream</code> stream regardless of whether a matching
symbol exists in the <code>TwitterStream</code> stream or not.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select S.symbol as symbol, T.tweet, S.price from StockStream window sliding_time(1 min) as S left outer join TwitterStream window sliding_length(1) as T on S.symbol== T.symbol insert into outputStream ;    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Right outer join</strong></p><p>  This is similar to a left outer join. <code>Right outer join</code> is used as the keyword to join both the streams.
It returns all the events of the right stream even if there are no matching events in the left stream.</p></li><li><p><strong>Full outer join</strong></p><p>  The full outer join combines the results of left outer join and right outer join. <code>full outer join</code> is used as the keyword to join both the streams.
Here, output event are generated for each incoming event even if there are no matching events in the other stream.</p><p>  <strong>Example</strong></p><p>  The following query generates output events for all the incoming events of each stream regardless of whether there is a
match for the <code>symbol</code> attribute in the other stream or not.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into outputStream select S.symbol as symbol, T.tweet, S.price from StockStream window sliding_time(1 min) as S full outer join TwitterStream window sliding_length(1) as T on S.symbol== T.symbol;    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="patterns">Patterns<a class="hash-link" href="#patterns" title="Direct link to heading">​</a></h3><p>This is a state machine implementation that allows you to detect patterns in the events that arrive over time. This can correlate events within a single stream or between multiple streams.</p><p><strong>Purpose</strong></p><p>Patterns allow you to identify trends in events over a time period.</p><p><strong>Syntax</strong></p><p>The following is the syntax for a pattern query:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;.&lt;attribute name&gt;, &lt;event reference&gt;.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;] -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (every)? &lt;event reference&gt;=&lt;input stream [&lt;filter condition&gt;] -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Items</th><th>Description</th></tr></thead><tbody><tr><td><code>-&gt;</code></td><td>This is used to indicate an event that should be following another event. The subsequent event does not necessarily have to occur immediately after the preceding event. The condition to be met by the preceding event should be added before the sign, and the condition to be met by the subsequent event should be added after the sign.</td></tr><tr><td><code>&lt;event reference&gt;</code></td><td>This allows you to add a reference to the the matching event so that it can be accessed later for further processing.</td></tr><tr><td><code>(within &lt;time gap&gt;)?</code></td><td>The <code>within</code> clause is optional. It defines the time duration within which all the matching events should occur.</td></tr><tr><td><code>every</code></td><td><code>every</code> is an optional keyword. This defines whether the event matching should be triggered for every event arrival in the specified stream with the matching condition.  When this keyword is not used, the matching is carried out only once.</td></tr></tbody></table><p>Stream also supports pattern matching with counting events and matching events in a logical order such as (<code>and</code>, <code>or</code>, and <code>not</code>). These are described in detail further below in this guide.</p><p><strong>Example</strong></p><p>This query sends an alert if the temperature of a room increases by 5 degrees within 10 min.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo, e1.temp as initialTemp, e2.temp as finalTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every( e1=TempStream ) -&gt; e2=TempStream[ e1.roomNo == roomNo and (e1.temp + 5) &lt;= temp ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    within 10 min;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the matching process begins for each event in the <code>TempStream</code> stream (because <code>every</code> is used with <code>e1=TempStream</code>),
and if  another event arrives within 10 minutes with a value for the <code>temp</code> attribute that is greater than or equal to <code>e1.temp + 5</code>
of the event e1, an output is generated via the <code>AlertStream</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="counting-pattern">Counting Pattern<a class="hash-link" href="#counting-pattern" title="Direct link to heading">​</a></h4><p>Counting patterns allow you to match multiple events that may have been received for the same matching condition.
The number of events matched per condition can be limited via condition postfixes.</p><p><strong>Syntax</strong></p><p>Each matching condition can contain a collection of events with the minimum and maximum number of events to be matched as shown in the syntax below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;([event index])?.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;] (&lt;&lt;min count&gt;:&lt;max count&gt;&gt;)? -&gt;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Postfix</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>&lt;n1:n2&gt;</code></td><td>This matches <code>n1</code> to <code>n2</code> events (including <code>n1</code> and not more than <code>n2</code>).</td><td><code>1:4</code> matches 1 to 4 events.</td></tr><tr><td><code>&lt;n:&gt;</code></td><td>This matches <code>n</code> or more events (including <code>n</code>).</td><td><code>&lt;2:&gt;</code> matches 2 or more events.</td></tr><tr><td><code>&lt;:n&gt;</code></td><td>This matches up to <code>n</code> events (excluding <code>n</code>).</td><td><code>&lt;:5&gt;</code> matches up to 5 events.</td></tr><tr><td><code>&lt;n&gt;</code></td><td>This matches exactly <code>n</code> events.</td><td><code>&lt;5&gt;</code> matches exactly 5 events.</td></tr></tbody></table><p>Specific occurrences of the event in a collection can be retrieved by using an event index with its reference.
Square brackets can be used to indicate the event index where <code>1</code> can be used as the index of the first event and <code>last</code> can be used as the index
for the <code>last</code> available event in the event collection. If you provide an index greater then the last event index,
the system returns <code>null</code>. The following are some valid examples.</p><ul><li><code>e1[3]</code> refers to the 3rd event.</li><li><code>e1[last]</code> refers to the last event.</li><li><code>e1[last - 1]</code> refers to the event before the last event.</li></ul><p><strong>Example</strong></p><p>The following stream worker calculates the temperature difference between two regulator events.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStream (deviceID long, roomNo int, tempSet double, isOn bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into TempDiffStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo, e2[0].temp - e2[last].temp as tempDiff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every( e1=RegulatorStream) -&gt; e2=TempStream[e1.roomNo==roomNo]&lt;1:&gt; -&gt; e3=RegulatorStream[e1.roomNo==roomNo];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="logical-patterns">Logical Patterns<a class="hash-link" href="#logical-patterns" title="Direct link to heading">​</a></h4><p>Logical patterns match events that arrive in temporal order and correlate them with logical relationships such as <code>and</code>,
<code>or</code> and <code>not</code>.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;([event index])?.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? (not)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ((and|or) &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;])? (within &lt;time gap&gt;)? -&gt;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Keywords such as <code>and</code>, <code>or</code>, or <code>not</code> can be used to illustrate the logical relationship.</p><table><thead><tr><th>Key Word</th><th>Description</th></tr></thead><tbody><tr><td><code>and</code></td><td>This allows both conditions of <code>and</code> to be matched by two events in any order.</td></tr><tr><td><code>or</code></td><td>The state succeeds if either condition of <code>or</code> is satisfied. Here the event reference of the other condition is <code>null</code>.</td></tr><tr><td><code>not &lt;condition1&gt; and &lt;condition2&gt;</code></td><td>When <code>not</code> is included with <code>and</code>, it identifies the events that match <code>&lt;condition2&gt;</code> arriving before any event that match <code>&lt;condition1&gt;</code>.</td></tr><tr><td><code>not &lt;condition&gt; for &lt;time period&gt;</code></td><td>When <code>not</code> is included with <code>for</code>, it allows you to identify a situation where no event that matches <code>&lt;condition1&gt;</code> arrives during the specified <code>&lt;time period&gt;</code>.  e.g.,<code>from not TemperatureStream[temp &gt; 60] for 5 sec</code>.</td></tr></tbody></table><p>Here the <code>not</code> pattern can be followed by either an <code>and</code> clause or the effective period of <code>not</code> can be concluded after a given <code>&lt;time period&gt;</code>. Further in Stream more than two streams cannot be matched with logical conditions using <code>and</code>, <code>or</code>, or <code>not</code> clauses at this point.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="detecting-non-occurring-events">Detecting Non-occurring Events<a class="hash-link" href="#detecting-non-occurring-events" title="Direct link to heading">​</a></h4><p>Stream allows you to detect non-occurring events via multiple combinations of the key words specified above as shown in the table below.</p><p>In the patterns listed, P* can be either a regular event pattern, an absent event pattern or a logical pattern.</p><table><thead><tr><th>Pattern</th><th>Detected Scenario</th></tr></thead><tbody><tr><td><code>not A for &lt;time period&gt;</code></td><td>The non-occurrence of event A within <code>&lt;time period&gt;</code> after system start up. e.g., Generating an alert if a taxi has not reached its destination within 30 minutes, to indicate that the passenger might be in danger.</td></tr><tr><td><code>not A for &lt;time period&gt; and B</code></td><td>After system start up, event A does not occur within <code>time period</code>, but event B occurs at some point in time.  e.g., Generating an alert if a taxi has not reached its destination within 30 minutes, and the passenger marked that he/she is in danger at some point in time.</td></tr><tr><td><code>not A for &lt;time period 1&gt; and not B for &lt;time period 2&gt;</code></td><td>After system start up, event A doess not occur within <code>time period 1</code>, and event B also does not occur within <code>&lt;time period 2&gt;</code>.  e.g., Generating an alert if the SDK of a taxi has not reached the destination within 30 minutes, and the passenger has not marked himself/herself to be in danger within that same time period.</td></tr><tr><td><code>not A for &lt;time period&gt; or B</code></td><td>After system start up, either event A does not occur within <code>&lt;time period&gt;</code>, or event B occurs at some point in time.  e.g., Generating an alert if the taxi has not reached its destination within 30 minutes, or if the passenger has marked that he/she is in danger at some point in time.</td></tr><tr><td><code>not A for &lt;time period 1&gt; or not B for &lt;time period 2&gt;</code></td><td>After system start up, either event A does not occur within <code>&lt;time period 1&gt;</code>, or event B occurs within <code>&lt;time period 2&gt;</code>.  e.g., Generating an alert to indicate that the SDK is not on an expected route if the taxi has not reached destination A within 20 minutes, or reached destination B within 30 minutes.</td></tr><tr><td><code>A → not B for &lt;time period&gt;</code></td><td>Event B does not occur within <code>&lt;time period&gt;</code> after the occurrence of event A. e.g., Generating an alert if the taxi has reached its destination, but this was not followed by a payment record.</td></tr><tr><td><code>P* → not A for &lt;time period&gt; and B</code></td><td>After the occurrence of P*, event A does not occur within <code>&lt;time period&gt;</code>, and event B occurs at some point in time.</td></tr><tr><td><code>P* → not A for &lt;time period 1&gt; and not B for &lt;time period 2&gt;</code></td><td>After the occurrence of P*, event A does not occur within <code>&lt;time period 1&gt;</code>, and event B does not occur within <code>&lt;time period 2&gt;</code>.</td></tr><tr><td><code>P* → not A for &lt;time period&gt; or B</code></td><td>After the occurrence of P*, either event A does not occur within <code>&lt;time period&gt;</code>, or event B occurs at some point in time.</td></tr><tr><td><code>P* → not A for &lt;time period 1&gt; or not B for &lt;time period 2&gt;</code></td><td>After the occurrence of P*, either event A does not occur within <code>&lt;time period 1&gt;</code>, or event B does not occur within <code>&lt;time period 2&gt;</code>.</td></tr><tr><td><code>not A for &lt;time period&gt; → B</code></td><td>Event A does occur within <code>&lt;time period&gt;</code> after the system start up, but event B occurs after that <code>&lt;time period&gt;</code> has elapsed.</td></tr><tr><td><code>not A for &lt;time period&gt; and B → P*</code></td><td>Event A does not occur within <code>&lt;time period&gt;</code>, and event B occurs at some point in time. Then P* occurs after the <code>&lt;time period&gt;</code> has elapsed, and after B has occurred.</td></tr><tr><td><code>not A for &lt;time period 1&gt; and not B for &lt;time period 2&gt; → P*</code></td><td>After system start up, event A does not occur within <code>&lt;time period 1&gt;</code>, and event B does not occur within <code>&lt;time period 2&gt;</code>. However, P* occurs after both A and B.</td></tr><tr><td><code>not A for &lt;time period&gt; or B → P*</code></td><td>After system start up, event A does not occur within <code>&lt;time period&gt;</code> or event B occurs at some point in time. The P* occurs after <code>&lt;time period&gt;</code> has elapsed, or after B has occurred.</td></tr><tr><td><code>not A for &lt;time period 1&gt; or not B for &lt;time period 2&gt; → P*</code></td><td>After system start up, either event A does not occur within <code>&lt;time period 1&gt;</code>, or event B does not occur within <code>&lt;time period 2&gt;</code>. Then P*  occurs after both <code>&lt;time period 1&gt;</code> and <code>&lt;time period 2&gt;</code> have elapsed.</td></tr><tr><td><code>not A and B</code></td><td>Event A does not occur before event B.</td></tr><tr><td><code>A and not B</code></td><td>Event B does not occur before event A.</td></tr></tbody></table><p><strong>Example</strong></p><p>Following stream worker, sends the <code>stop</code> control action to the regulator when the key is removed from the hotel room.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStateChangeStream (deviceID long, roomNo int, tempSet double, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RoomKeyStream (deviceID long, roomNo int, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into RegulatorActionStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo, ifThenElse( e2 is null, &#x27;none&#x27;, &#x27;stop&#x27; ) as action</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every( e1=RegulatorStateChangeStream[ action == &#x27;on&#x27; ] ) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      e2=RoomKeyStream[ e1.roomNo == roomNo and action == &#x27;removed&#x27; ] or e3=RegulatorStateChangeStream[ e1.roomNo == roomNo and action == &#x27;off&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having action != &#x27;none&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This stream worker generates an alert if we have switch off the regulator before the temperature reaches 12 degrees.  </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStateChangeStream (deviceID long, roomNo int, tempSet double, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo as roomNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from e1=RegulatorStateChangeStream[action == &#x27;start&#x27;] -&gt; not TempStream[e1.roomNo == roomNo and temp &lt; 12] and e2=RegulatorStateChangeStream[action == &#x27;off&#x27;];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This stream worker generates an alert if the temperature does not reduce to 12 degrees within five minutes of switching on the regulator.  </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStateChangeStream (deviceID long, roomNo int, tempSet double, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo as roomNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from e1=RegulatorStateChangeStream[action == &#x27;start&#x27;] -&gt; not TempStream[e1.roomNo == roomNo and temp &lt; 12] for 5 min;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sequence">Sequence<a class="hash-link" href="#sequence" title="Direct link to heading">​</a></h3><p>Sequence is a state machine implementation that allows you to detect the sequence of event occurrences over time.
Here <strong>all matching events need to arrive consecutively</strong> to match the sequence condition, and there cannot be any non-matching events arriving within a matching sequence of events.
This can correlate events within a single stream or between multiple streams.</p><p><strong>Purpose</strong></p><p>This allows you to detect a specified event sequence over a specified time period.</p><p><strong>Syntax</strong></p><p>The syntax for a sequence query is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;.&lt;attribute name&gt;, &lt;event reference&gt;.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;event reference&gt;=&lt;input stream [&lt;filter condition&gt;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Items</th><th>Description</th></tr></thead><tbody><tr><td><code>,</code></td><td>This represents the immediate next event i.e., when an event that matches the first condition arrives, the event that arrives immediately after it should match the second condition.</td></tr><tr><td><code>&lt;event reference&gt;</code></td><td>This allows you to add a reference to the the matching event so that it can be accessed later for further processing.</td></tr><tr><td><code>(within &lt;time gap&gt;)?</code></td><td>The <code>within</code> clause is optional. It defines the time duration within which all the matching events should occur.</td></tr><tr><td><code>every</code></td><td><code>every</code> is an optional keyword. This defines whether the matching event should be triggered for every event that arrives at the specified stream with the matching condition.  When this keyword is not used, the matching is carried out only once.</td></tr></tbody></table><p><strong>Example</strong></p><p>This query generates an alert if the increase in the temperature between two consecutive temperature events exceeds one degree.</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> e1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> initialTemp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> finalTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> every e1</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">TempStream</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e2</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">TempStream</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">e1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">temp</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="counting-sequence">Counting Sequence<a class="hash-link" href="#counting-sequence" title="Direct link to heading">​</a></h4><p>Counting sequences allow you to match multiple events for the same matching condition.
The number of events matched per condition can be limited via condition postfixes such as <strong>Counting Patterns</strong>, or by using the
<code>*</code>, <code>+</code>, and <code>?</code> operators.</p><p>The matching events can also be retrieved using event indexes, similar to how it is done in <strong>Counting Patterns</strong>.</p><p><strong>Syntax</strong></p><p>Each matching condition in a sequence can contain a collection of events as shown below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;.&lt;attribute name&gt;, &lt;event reference&gt;.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;](+|*|?)?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;event reference&gt;=&lt;input stream [&lt;filter condition&gt;](+|*|?)?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Postfix symbol</th><th>Required/Optional</th><th>Description</th></tr></thead><tbody><tr><td><code>+</code></td><td>Optional</td><td>This matches <strong>one or more</strong> events to the given condition.</td></tr><tr><td><code>*</code></td><td>Optional</td><td>This matches <strong>zero or more</strong> events to the given condition.</td></tr><tr><td><code>?</code></td><td>Optional</td><td>This matches <strong>zero or one</strong> events to the given condition.</td></tr></tbody></table><p><strong>Example</strong></p><p>This stream worker identifies temperature peeks.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream(deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into PeekTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.temp as initialTemp, e2[last].temp as peakTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every e1=TempStream, e2=TempStream[e1.temp &lt;= temp]+, e3=TempStream[e2[last].temp &gt; temp];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="logical-sequence">Logical Sequence<a class="hash-link" href="#logical-sequence" title="Direct link to heading">​</a></h4><p>Logical sequences identify logical relationships using <code>and</code>, <code>or</code> and <code>not</code> on consecutively arriving events.</p><p><strong>Syntax</strong>
The syntax for a logical sequence is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;([event index])?.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? (not)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ((and|or) &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;])? (within &lt;time gap&gt;)?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Keywords such as <code>and</code>, <code>or</code>, or <code>not</code> can be used to illustrate the logical relationship, similar to how it is done in <strong>Logical Patterns</strong>.</p><p><strong>Example</strong></p><p>This stream worker notifies the state when a regulator event is immediately followed by both temperature and humidity events.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream(deviceID long, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM HumidStream(deviceID long, humid double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStream(deviceID long, isOn bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into StateNotificationStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e2.temp, e3.humid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every e1=RegulatorStream, e2=TempStream and e3=HumidStream;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="output-rate-limiting">Output rate limiting<a class="hash-link" href="#output-rate-limiting" title="Direct link to heading">​</a></h3><p>Output rate limiting allows queries to output events periodically based on a specified condition.</p><p><strong>Purpose</strong></p><p>This allows you to limit the output to avoid overloading the subsequent executions, and to remove unnecessary information.</p><p><strong>Syntax</strong></p><p>The syntax of an output rate limiting configuration is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output &lt;rate limiting configuration&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Stream supports three types of output rate limiting configurations as explained in the following table:</p><table><thead><tr><th>Rate limiting configuration</th><th>Syntax</th><th>Description</th></tr></thead><tbody><tr><td>Based on time</td><td><code>&lt;output event&gt; every &lt;time interval&gt;</code></td><td>This outputs <code>&lt;output event&gt;</code> every <code>&lt;time interval&gt;</code> time interval.</td></tr><tr><td>Based on number of events</td><td><code>&lt;output event&gt; every &lt;event interval&gt; events</code></td><td>This outputs <code>&lt;output event&gt;</code> for every <code>&lt;event interval&gt;</code> number of events.</td></tr><tr><td>Snapshot based output</td><td><code>snapshot every &lt;time interval&gt;</code></td><td>This outputs all events in the window (or the last event if no window is defined in the query) for every given <code>&lt;time interval&gt;</code> time interval.</td></tr></tbody></table><p>Here the <code>&lt;output event&gt;</code> specifies the event(s) that should be returned as the output of the query.
The possible values are as follows:</p><ul><li><code>first</code> : Only the first event processed by the query during the specified time interval/sliding window is emitted.</li><li><code>last</code> : Only the last event processed by the query during the specified time interval/sliding window is emitted.</li><li><code>all</code> : All the events processed by the query during the specified time interval/sliding window are emitted. <strong>When no <code>&lt;output event&gt;</code> is defined, <code>all</code> is used by default.</strong></li></ul><p><strong>Examples</strong></p><ul><li><p>Returning events based on the number of events</p><p>  Here, events are emitted every time the specified number of events arrive. You can also specify whether to emit only the first event/last event, or all the events out of the events that arrived.</p><p>  In this example, the last temperature per sensor is emitted for every 10 events.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into LowRateTempStream select temp, deviceID from TempStreamselect group by deviceID output last every 10 events;    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Returning events based on time</p><p>  Here events are emitted for every predefined time interval. You can also specify whether to emit only the first event, last event, or all events out of the events that arrived during the specified time interval.</p><p>  In this example, emits all temperature events every 10 seconds  </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into LowRateTempStream from TempStreamoutput output every 10 sec;    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Returning a periodic snapshot of events</p><p>  This method works best with windows. When an input stream is connected to a window, snapshot rate limiting emits all the current events that have arrived and do not have corresponding expired events for every predefined time interval.
If the input stream is not connected to a window, only the last current event for each predefined time interval is emitted.</p><p>  This query emits a snapshot of the events in a time window of 5 seconds every 1 second.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">insert into SnapshotTempStream from TempStream window sliding_time(5 sec) output snapshot every 1 sec;    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/macrometacorp/docs/edit/main/docs/cep/query-guide/query.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cep/query-guide/stream"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Stream</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cep/query-guide/partition"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Partition</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#value" class="table-of-contents__link toc-highlight">Value</a></li><li><a href="#select" class="table-of-contents__link toc-highlight">Select</a></li><li><a href="#function" class="table-of-contents__link toc-highlight">Function</a></li><li><a href="#filter" class="table-of-contents__link toc-highlight">Filter</a></li><li><a href="#window" class="table-of-contents__link toc-highlight">Window</a></li><li><a href="#event-type" class="table-of-contents__link toc-highlight">Event Type</a></li><li><a href="#aggregate-function" class="table-of-contents__link toc-highlight">Aggregate Function</a></li><li><a href="#group-by" class="table-of-contents__link toc-highlight">Group By</a></li><li><a href="#having" class="table-of-contents__link toc-highlight">Having</a></li><li><a href="#order-by" class="table-of-contents__link toc-highlight">Order By</a></li><li><a href="#limit--offset" class="table-of-contents__link toc-highlight">Limit &amp; Offset</a></li><li><a href="#join-stream" class="table-of-contents__link toc-highlight">Join (Stream)</a></li><li><a href="#patterns" class="table-of-contents__link toc-highlight">Patterns</a></li><li><a href="#sequence" class="table-of-contents__link toc-highlight">Sequence</a></li><li><a href="#output-rate-limiting" class="table-of-contents__link toc-highlight">Output rate limiting</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/apps">Sample Apps</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/release-notes">Release Notes</a></li></ul></div><div class="col footer__col"><div class="footer__title">Developer Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Macrometacorp/jsC8" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">Javascript<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Macrometacorp/pyC8" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">Python<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.npmjs.com/package/gdnsl" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">CLI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/macrometacorp" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/macrometa/shared_invite/zt-1j4f06xwm-5Y~yGQz8CVImOowdc80s1A" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/macrometa" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://support.macrometa.com" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://status.macrometa.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item footer__item--external">System Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2023 Macrometa • All rights reserved</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.ba2405bf.js"></script>
<script src="/docs/assets/js/main.55f2bcd5.js"></script>
</body>
</html>